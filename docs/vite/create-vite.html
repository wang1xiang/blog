<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>
      ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼šä½ è¿˜ä¸æ‡‚create-viteåŸç†å—ï¼Ÿæ¥ä¸€èµ·åº·åº·ã€‚ | å­¦ä¹ ç¬”è®°
    </title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/blog/_assets/style.85766dd9.css">
    <link rel="modulepreload" href="/blog/_assets/common-03e46d7f.js">
    <link rel="modulepreload" href="/blog/_assets/docs_vite_create-vite.md.35b04b3d.lean.js">
    <link rel="modulepreload" href="/blog/_assets/app.41c738e0.js">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="keywords" content="ç¿”å­Blog">
    <link rel="icon" href="/blog/favicon.ico">
    <link rel="stylesheet" href="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.css">
    <script src="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.js"></script>
    <script src="https://lib.baomitu.com/axios/0.21.1/axios.js"></script>
    
  </head>
  <body>
    <div id="app"><!--[--><div id="containerColor" class="no-sidebar theme" data-v-afcf09d4><header class="navbar" data-v-afcf09d4><!--[--><a class="title" aria-label="å­¦ä¹ ç¬”è®°, back to home" href="/blog/"><img class="logo" src="/blog/favicon.ico" alt="logo"><span>å­¦ä¹ ç¬”è®°</span></a><div class="flex-grow"></div><nav class="nav-links hide-mobile"><!--[--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--]--><div id="docsearch"></div><!----><!----></nav><!--[--><!--]--><!--]--><div class="sidebar-button" data-v-afcf09d4><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div></header><aside class="" data-v-afcf09d4><!--[--><nav class="nav-links show-mobile"><!--[--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--]--><div id="docsearch"></div><!----><!----></nav><!--[--><!--]--><ul class="sidebar"><!--[--><!--]--></ul><!--[--><!--]--><!--]--></aside><!----><!-- TODO: make this button accessible --><div class="sidebar-mask" data-v-afcf09d4></div><main data-v-afcf09d4><!--[--><div class="content"><!--[--><!--]--><div class="md-header"><div class="md-title">ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼šä½ è¿˜ä¸æ‡‚create-viteåŸç†å—ï¼Ÿæ¥ä¸€èµ·åº·åº·ã€‚</div><span id="jinrishici-sentence">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯....</span><div class="md-date">2023-03-24</div></div><ul class="catalog"><!--[--><li class="catalog-item"><a class="level level-2" href="#å‰è¨€">å‰è¨€</a><!----></li><li class="catalog-item"><a class="level level-2" href="#ä½¿ç”¨-vite-åˆ›å»ºé¡¹ç›®">ä½¿ç”¨ vite åˆ›å»ºé¡¹ç›®</a><!----></li><li class="catalog-item"><a class="level level-2" href="#é¡¹ç›®å…‹éš†">é¡¹ç›®å…‹éš†</a><!----></li><li class="catalog-item"><a class="level level-2" href="#ç¡®å®šå…¥å£">ç¡®å®šå…¥å£</a><!----></li><li class="catalog-item"><a class="level level-2" href="#å¼€å§‹è°ƒè¯•">å¼€å§‹è°ƒè¯•</a><!----></li><li class="catalog-item"><!----><a class="level level-3" href="#ç¡®å®šé¡¹ç›®åç§°åŠé¢„è®¾æ¨¡ç‰ˆ">ç¡®å®šé¡¹ç›®åç§°åŠé¢„è®¾æ¨¡ç‰ˆ</a></li><li class="catalog-item"><!----><a class="level level-3" href="#è¦†ç›–å·²æœ‰ç›®å½•-åˆ›å»ºä¸å­˜åœ¨çš„é¡¹ç›®ç›®å½•">è¦†ç›–å·²æœ‰ç›®å½•/åˆ›å»ºä¸å­˜åœ¨çš„é¡¹ç›®ç›®å½•</a></li><li class="catalog-item"><!----><a class="level level-3" href="#ç¡®å®šæ¨¡æ¿-template">ç¡®å®šæ¨¡æ¿ template</a></li><li class="catalog-item"><!----><a class="level level-3" href="#ç¡®å®šåŒ…ç®¡ç†å™¨-pkgmanager">ç¡®å®šåŒ…ç®¡ç†å™¨ pkgManager</a></li><li class="catalog-item"><!----><a class="level level-3" href="#customcommand-è‡ªå®šä¹‰å‘½ä»¤">customCommand è‡ªå®šä¹‰å‘½ä»¤</a></li><li class="catalog-item"><!----><a class="level level-3" href="#è¾“å‡ºæ¨¡æ¿å†…å®¹åˆ°ç›®å½•">è¾“å‡ºæ¨¡æ¿å†…å®¹åˆ°ç›®å½•</a></li><li class="catalog-item"><a class="level level-2" href="#æ€»ç»“">æ€»ç»“</a><!----></li><!--]--></ul><div><blockquote><p>æœ¬æ–‡å‚åŠ äº†ç”±<a href="https://lxchuan12.gitee.io/" target="_blank" rel="noopener noreferrer">å…¬ä¼—å·@è‹¥å·è§†é‡</a>å‘èµ·çš„æ¯å‘¨æºç å…±è¯»æ´»åŠ¨ï¼Œ<a href="https://juejin.cn/post/7079706017579139102" target="_blank" rel="noopener noreferrer">ç‚¹å‡»äº†è§£è¯¦æƒ…ä¸€èµ·å‚ä¸</a>ã€‚ è¿™æ˜¯æºç å…±è¯»çš„ç¬¬ 37 æœŸï¼Œé“¾æ¥ï¼š<a href="https://juejin.cn/post/7129087028947320862/" target="_blank" rel="noopener noreferrer">vite 3.0 éƒ½å‘å¸ƒäº†ï¼Œè¿™æ¬¡æ¥æ‰‹æ’• create-vite æºç </a>ã€‚ ç¬¬ä¸€æ¬¡å‚åŠ æºç å…±è¯»ï¼Œæœ‰åšçš„ä¸å¥½çš„åœ°æ–¹ï¼Œå°±å¤§å®¶å¤šå¤šæŒ‡æ•™ã€‚</p></blockquote><h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€" aria-hidden="true">#</a> å‰è¨€</h2><p>æœ€è¿‘åœ¨å­¦ä¹ <a href="https://www.zhangxinxu.com/" target="_blank" rel="noopener noreferrer">å¼ é‘«æ—­</a>å¤§ä½¬çš„<a href="https://juejin.cn/book/7184663814950879270?enter_from=course_center&amp;utm_source=course_center" target="_blank" rel="noopener noreferrer">æŠ€æœ¯å†™ä½œæŒ‡å—</a>ï¼Œæœ‰å¥è¯æˆ‘çœ‹äº†å¾ˆæœ‰æ„Ÿè§¦ï¼Œâ€œä¸€ä¸ªçŸ¥è¯†ç‚¹è¦æƒ³æ·±å…¥æµ…å‡ºï¼Œå‰æå°±æ˜¯ä½œè€…æœ¬äººçš„ç†è§£è¶³å¤Ÿæ·±å…¥ï¼Œè¿™æ ·å³ä¾¿é‡åˆ°é—®é¢˜ï¼Œä¹Ÿä¸ä¼šæŸæ‰‹æ— ç­–ã€‚</p><p>å…¬å¸æœ€è¿‘æƒ³æŠŠé¡¹ç›®çš„ webpack æ›¿æ¢æˆ viteï¼Œè¶è¿™ä¸ªæœºä¼šä¸€æ¬¡æŠŠ vite ç»™æ•´æ˜ç™½äº†ï¼Œäº‰å–é¢è¯•æ—¶å’Œé¢è¯•å®˜ä¸€èµ·æ¢è®¨ä¸€ä¸‹ viteã€‚</p><p>åŠ äº†å¾ˆä¹…çš„æºç å…±è¯»ç¾¤ï¼Œä¸€ç›´æ²¡æ—¶é—´ï¼ˆæ‡’çš„ï¼‰å­¦ä¹ ï¼Œè¿™æ¬¡éš¾å¾—æŠŠæ‘¸é±¼çš„æ—¶é—´æŠ½å‡ºæ¥ï¼ŒèŠ±äº†ä¸€å‘¨æ—¶é—´ï¼Œè®¤çœŸè¯»äº†ä¸€éæºç å¹¶å†™ä¸ªæ–‡ç« æ€»ç»“ä¸€ä¸‹ã€‚</p><p><img src="/blog/_assets/moyu.9f3d9e12.gif" alt="moyu.gif"></p><p>æ¥ä¸‹æ¥ï¼Œæœ‰è¯·å„ä½å°ä¼™ä¼´åŒæˆ‘ä¸€èµ·æ•²å¼€æºç çš„å¤§é—¨å§ ğŸ‘ã€‚</p><h2 id="ä½¿ç”¨-vite-åˆ›å»ºé¡¹ç›®"><a class="header-anchor" href="#ä½¿ç”¨-vite-åˆ›å»ºé¡¹ç›®" aria-hidden="true">#</a> ä½¿ç”¨ vite åˆ›å»ºé¡¹ç›®</h2><blockquote><p>å‡ ä¸ªæœˆå‰ï¼ŒVite å·²ç»å‡çº§åˆ° 4.0 ç‰ˆæœ¬ï¼Œæ­¤æ—¶è·ç¦» Vite 3.0 å‘å¸ƒå¿«ä¸€å¹´äº†ã€‚4.0 ç‰ˆæœ¬å®Œæˆ Rollup 2.0 åˆ° 3.0 çš„å‡çº§ï¼ŒåŒæ—¶å¢åŠ äº†å¯¹ SWC çš„æ”¯æŒï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº Rust &gt; çš„æ‰“åŒ…å™¨ï¼ˆbundlerï¼‰ï¼Œå£°ç§°æ¯” Babel æœ‰æ•°é‡çº§çš„é€Ÿåº¦æå‡ã€‚</p></blockquote><p>åœ¨å¼€å§‹æºç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç”¨ <a href="https://cn.vitejs.dev/guide/#scaffolding-your-first-vite-project" target="_blank" rel="noopener noreferrer">vite åˆ›å»ºä¸€ä¸ªé¡¹ç›®</a>çœ‹çœ‹ã€‚è¿™é‡Œæˆ‘ç”¨çš„æ˜¯ pnpmï¼Œå¯¹ pnpm è¿˜ä¸ç†Ÿæ‚‰çš„åŒå­¦ï¼Œå»ºè®®å…ˆçœ‹çœ‹<a href="https://pnpm.io/zh/" target="_blank" rel="noopener noreferrer">å®˜ç½‘</a>çš„è®²è§£ã€‚</p><div class="language-bash"><pre><code><span class="token function">pnpm</span> create vite my-vue-app
</code></pre></div><!-- ![pnpm-create-vite.gif](./images/pnpm-create-vite.gif) --><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šæ¨¡æ¿çš„æ–¹å¼ä¸€æ­¥åˆ°ä½</p><div class="language-bash"><pre><code><span class="token function">pnpm</span> create vite my-vue-app --template vue-ts
</code></pre></div><p><img src="/blog/_assets/pnpm-create-tem.01af0402.gif" alt="pnpm-create-tem"></p><p>vite å¯ä»¥å¾ˆå¿«é€Ÿçš„å¸®æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œé‚£ä¹ˆè¿™äº›é€‰æ‹©æç¤ºä»¥åŠæ¨¡æ¿ä¸­çš„æ–‡ä»¶éƒ½æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿå¸¦ç€é—®é¢˜æˆ‘ä»¬æ¥å­¦ä¹ ä¸€æ³¢ vite çš„æºç ï¼Œåšåˆ°<strong>çŸ¥å…¶ç„¶ï¼Œæ›´çŸ¥å…¶æ‰€ä»¥ç„¶</strong>ã€‚</p><h2 id="é¡¹ç›®å…‹éš†"><a class="header-anchor" href="#é¡¹ç›®å…‹éš†" aria-hidden="true">#</a> é¡¹ç›®å…‹éš†</h2><p>create-vite çš„æºç åœ°å€åœ¨ vite é¡¹ç›®ä¸‹ï¼š<a href="https://github.com/vitejs/vite/blob/HEAD/packages/create-vite/index.js" target="_blank" rel="noopener noreferrer">github.com/vitejs/viteâ€¦</a>ï¼Œæˆ‘æ˜¯æŠŠæ•´ä¸ª vite clone ä¸‹æ¥ä¹‹åï¼Œå†æŠŠ create-vite çš„ä»£ç æ‹†å‡ºæ¥ï¼Œä¸Šä¼ åˆ° github ä¸Šã€‚</p><p>github åœ°å€: <a href="https://github.com/wang1xiang/create-vite-analysis" target="_blank" rel="noopener noreferrer">https://github.com/wang1xiang/create-vite-analysis</a></p><h2 id="ç¡®å®šå…¥å£"><a class="header-anchor" href="#ç¡®å®šå…¥å£" aria-hidden="true">#</a> ç¡®å®šå…¥å£</h2><p>é€šè¿‡<a href="https://docs.npmjs.com/cli/v8/commands/npm-init#Synopsis" target="_blank" rel="noopener noreferrer">npm init æ–‡æ¡£</a>æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œcreate å°±æ˜¯ init çš„åˆ«åã€‚æ‰€ä»¥ä¸Šé¢çš„å‘½ä»¤<code>pnpm create vite</code>å°±ç›¸å½“äº<code>pnpm init vite</code>ã€‚</p><p>ç»§ç»­é€šè¿‡<a href="https://docs.npmjs.com/cli/v8/commands/npm-init#description" target="_blank" rel="noopener noreferrer">æè¿°</a>äº†è§£åˆ° init å‘½ä»¤ä¼šè½¬æ¢ä¸º npm execï¼Œæ‰€ä»¥<code>pnpm create vite</code>æœ€ç»ˆè¢«è½¬æ¢ä¸º<code>pnpm exec create-vite</code>ï¼Œå³<code>npx create-vite</code>ã€‚</p><p><a href="https://docs.npmjs.com/cli/v7/commands/npx#npx-vs-npm-exec" target="_blank" rel="noopener noreferrer">å…³äº npx ä¸ npm exec çš„å¯¹æ¯”</a></p><p>ç„¶åé€šè¿‡ npm-exec å®‰è£…å¥½ create-vite åŒ…ï¼Œæ¥ç€æ‰§è¡Œå…¶ package.json æ–‡ä»¶ä¸­<code>bin</code>é‡Œçš„å‘½ä»¤ã€‚</p><blockquote><p>bin é‡Œçš„å‘½ä»¤å¯¹åº”çš„æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶ï¼Œé€šè¿‡è½¯é“¾æ¥æˆ–è€…ç¬¦å·é“¾æ¥åˆ°æŒ‡å®šèµ„æºçš„æ˜ å°„ï¼Œè¿™äº›å¯æ‰§è¡Œæ–‡ä»¶å¿…é¡»ä»¥ #!/usr/bin/env node å¼€å¤´ï¼Œå¦åˆ™è„šæœ¬å°†åœ¨æ²¡æœ‰ node å¯æ‰§è¡Œæ–‡ä»¶çš„æƒ…å†µä¸‹å¯åŠ¨ã€‚</p></blockquote><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹ create-vite çš„ package.json æ–‡ä»¶ï¼Œå‚è€ƒ<a href="http://caibaojian.com/npm/files/package.json.html#bin" target="_blank" rel="noopener noreferrer">npm å…³äº package.json ä¸­ bin çš„è§£é‡Š</a>ã€‚</p><div class="language-json"><pre><code><span class="token punctuation">{</span>
  ...
  <span class="token property">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;create-vite&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cva&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span>
</code></pre></div><p>é€šè¿‡ä»¥ä¸Šå†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æœ€ç»ˆæ‰§è¡Œçš„æ˜¯å½“å‰ç›®å½•ä¸‹çš„<code>index.js</code>æ–‡ä»¶</p><div class="language-js"><pre><code><span class="token hashbang comment">#!/usr/bin/env node</span>

<span class="token keyword">import</span> <span class="token string">&#39;./dist/index.mjs&#39;</span>
</code></pre></div><p>è¿™é‡Œçš„<code>./dist/index.mjs</code>æ˜¯æ‰“åŒ…åçš„è·¯å¾„ï¼Œå®é™…æ‰§è¡Œçš„å…¶å®æ˜¯<code>./src/index.ts</code>ï¼Œå³ç¡®å®šå…¥å£æ–‡ä»¶ä¸º<code>./src/index.ts</code>ã€‚ ä¸‹é¢è®©æˆ‘ä»¬é€šè¿‡è°ƒè¯•çš„æ–¹å¼æ¥å¯¹ create-vite åšä¸€ä¸ªæ·±å…¥çš„äº†è§£ï¼Œä¸æ‡‚å¦‚ä½•è°ƒè¯•çš„å°ä¼™ä¼´ï¼Œè¯·å‚è€ƒ<a href="https://juejin.cn/post/7030584939020042254" target="_blank" rel="noopener noreferrer">æ–°æ‰‹å‘ï¼šå‰ç«¯ç¨‹åºå‘˜å¿…å­¦åŸºæœ¬æŠ€èƒ½â€”â€”è°ƒè¯• JS ä»£ç </a>ã€‚</p><h2 id="å¼€å§‹è°ƒè¯•"><a class="header-anchor" href="#å¼€å§‹è°ƒè¯•" aria-hidden="true">#</a> å¼€å§‹è°ƒè¯•</h2><p>é¦–å…ˆæˆ‘ä»¬å…ˆé€šè¿‡<code>cmd + K cmd + 0</code>æ”¶èµ·æ‰€æœ‰å‡½æ•°ï¼Œçœ‹ä¸‹æ•´ä½“ä»£ç å¦‚ä¸‹</p><p><img src="/blog/_assets/create-vite-index.53399bc4.png" alt="create-vite-index.png"></p><p>å¹¶ä¸å¤šå“¦ï¼Œé™¤å»ç±»å‹å®šä¹‰ä¹Ÿå°± 400 è¡Œå·¦å³ã€‚</p><p>é¦–å…ˆå…ˆçœ‹ä¸€ä¸‹å¼•å…¥åŒ…çš„ä½œç”¨ï¼š</p><ul><li><p>å‡ ä¸ª Node é‡Œé¢å¸¸ç”¨æ¨¡å—ï¼šfs æ–‡ä»¶æ¨¡å—ã€path è·¯å¾„å¤„ç†æ¨¡å—ä»¥åŠ fileURLToPath è½¬æ–‡ä»¶è·¯å¾„æ¨¡å—ï¼›</p></li><li><p><a href="https://github.com/moxystudio/node-cross-spawn" target="_blank" rel="noopener noreferrer">cross-spawn</a> è‡ªåŠ¨æ ¹æ®è¿è¡Œå¹³å°ï¼ˆwindowsã€macã€linux ç­‰ï¼‰ç”Ÿæˆ shell å‘½ä»¤ï¼Œå¹¶æ‰§è¡Œï¼›</p></li><li><p><a href="https://github.com/minimistjs/minimist" target="_blank" rel="noopener noreferrer">minimist</a> è§£æå‘½ä»¤è¡Œä¼ å…¥çš„å‚æ•°ï¼›</p><div class="language-bash"><pre><code><span class="token function">node</span> example/parse.js test1 test2 -a beep -b boop
<span class="token comment"># è¾“å‡º { _: [test1, test2], a: &#39;beep&#39;, b: &#39;boop&#39; }</span>
</code></pre></div></li><li><p><a href="https://github.com/terkelg/prompts" target="_blank" rel="noopener noreferrer">prompts</a> å‘½ä»¤è¡Œäº¤äº’æç¤ºï¼›</p></li><li><p><a href="https://github.com/marvinhagemeister/kolorist" target="_blank" rel="noopener noreferrer">kolorist</a> ç»™è¾“å…¥è¾“å‡ºä¸Šé¢œè‰²ï¼›</p></li></ul><p>åœ¨ index.ts æœ€åå¯ä»¥çœ‹åˆ°ä¼šæ‰§è¡Œ init å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä» init å‡½æ•°å¼€å§‹è°ƒè¯•å§ï¼</p><h3 id="ç¡®å®šé¡¹ç›®åç§°åŠé¢„è®¾æ¨¡ç‰ˆ"><a class="header-anchor" href="#ç¡®å®šé¡¹ç›®åç§°åŠé¢„è®¾æ¨¡ç‰ˆ" aria-hidden="true">#</a> ç¡®å®šé¡¹ç›®åç§°åŠé¢„è®¾æ¨¡ç‰ˆ</h3><div class="language-js"><pre><code><span class="token keyword">const</span> defaultTargetDir <span class="token operator">=</span> <span class="token string">&#39;vite-project&#39;</span>

<span class="token keyword">async</span> <span class="token keyword">const</span> <span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// è·å–ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•° å»é™¤å‰åç©ºæ ¼ä»¥åŠæœ«å°¾çš„/</span>
  <span class="token keyword">const</span> argTargetDir <span class="token operator">=</span> <span class="token function">formatTargetDir</span><span class="token punctuation">(</span>argv<span class="token punctuation">.</span>_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// è·å–ä¼ å…¥çš„æ¨¡æ¿</span>
  <span class="token keyword">const</span> argTemplate <span class="token operator">=</span> argv<span class="token punctuation">.</span>template <span class="token operator">||</span> argv<span class="token punctuation">.</span>t
  <span class="token comment">// ç¡®å®šè¾“å‡ºç›®å½•</span>
  <span class="token keyword">let</span> targetDir <span class="token operator">=</span> argTargetDir <span class="token operator">||</span> defaultTargetDir
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/blog/_assets/debugger-init.05c3a015.gif" alt="debugger-init.gif"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨ init è¿™é‡Œæ‰“ä¸ªæ–­ç‚¹ï¼Œä½¿ç”¨<a href="https://github.com/esbuild-kit/esno" target="_blank" rel="noopener noreferrer">esno</a>æ¥è¿è¡Œ ts ä»£ç ã€‚</p><p>å¯ä»¥çœ‹åˆ°å½“æˆ‘ä»¬æœ‰ä¼ å…¥é¡¹ç›®åç§°ä»¥åŠæ¨¡æ¿æ—¶ï¼Œé€šè¿‡ minimist æ‹¿åˆ°äº†ä¼ å…¥çš„å‚æ•°ï¼Œå¦‚æœè¾“å…¥åˆæ³•çš„æƒ…å†µä¸‹ï¼Œå°±ä¼šè·³è¿‡ prompts è¯¢é—®ç¯èŠ‚ï¼Œç»§ç»­<a href="./.html">ä¸‹ä¸€æ­¥</a>ã€‚</p><blockquote><p>è¾“å…¥åˆæ³•æŒ‡çš„æ˜¯ï¼šå½“å‰ç›®å½•ä¸å­˜åœ¨è¾“å…¥çš„é¡¹ç›®åç§°çš„æ–‡ä»¶ã€è¾“å…¥çš„æ¨¡æ¿åˆæ³•ï¼›å¦‚æœè¾“å…¥ä¸åˆæ³•çš„æƒ…å†µä¸‹è¿˜æ˜¯ä¼šè¿›å…¥ prompts è¯¢é—®ç¯èŠ‚</p></blockquote><p>å¹³æ—¶åˆå§‹åŒ–é¡¹ç›®ï¼Œéƒ½æ˜¯ä½¿ç”¨<code>--template</code>æ¥åˆ›å»ºæŒ‡å®šæ¨¡æ¿ï¼Œé€šè¿‡æºç çœ‹åˆ°ä¹Ÿå¯ä»¥é€šè¿‡<code>--t</code>æ¥åˆ›å»ºæ¨¡æ¿ï¼Œå­¦åˆ°äº†ã€‚</p><p>è¿™é‡Œæ ¹æ®ä¼ å…¥çš„å‚æ•°å¾—åˆ°é¡¹ç›®åç§°ä»¥åŠé¢„è®¾æ¨¡ç‰ˆï¼Œå¦‚æœ<strong>æœªä¼ å…¥</strong>æ—¶é€šè¿‡ prompts æ¥ç¡®å®šé¡¹ç›®åç§°å’Œé¢„è®¾æ¨¡æ¿ã€‚</p><div class="language-js"><pre><code><span class="token comment">// å¦‚æœç”¨æˆ·ä¼ å…¥å‚æ•°å¹¶ä¸”ç¬¦åˆè§„åˆ™æ—¶ å°±ä¸ä¼šè¿›å…¥è¯¢é—®</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">prompts</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span>
      <span class="token comment">// è·å–ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶åå¹¶ä½œä¸ºæœ€ç»ˆè¾“å‡ºç›®å½•</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> argTargetDir <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token string">&#39;text&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;projectName&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token string">&#39;Project name:&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">initial</span><span class="token operator">:</span> defaultTargetDir<span class="token punctuation">,</span>
        <span class="token function-variable function">onState</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          targetDir <span class="token operator">=</span> <span class="token function">formatTargetDir</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token operator">||</span> defaultTargetDir
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// å½“ç›®å½•å­˜åœ¨æˆ–ç›®å½•ä¸ä¸ºç©ºæ—¶ è¯¢é—®æ˜¯å¦è¦†ç›–æ‰</span>
      <span class="token punctuation">{</span>
        <span class="token function-variable function">type</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
          <span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>targetDir<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span>targetDir<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token string">&#39;confirm&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;overwrite&#39;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">message</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
          <span class="token punctuation">(</span>targetDir <span class="token operator">===</span> <span class="token string">&#39;.&#39;</span>
            <span class="token operator">?</span> <span class="token string">&#39;Current directory&#39;</span>
            <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Target directory &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>targetDir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token operator">+</span>
          <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> is not empty. Remove existing files and continue?</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// äºŒæ¬¡ç¡®è®¤æ˜¯å¦è¾“å…¥çš„y å¦‚æœè¾“å…¥Nï¼ˆfalseï¼‰æ—¶ç›´æ¥é€€å‡º</span>
      <span class="token punctuation">{</span>
        <span class="token function-variable function">type</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> <span class="token punctuation">{</span> overwrite <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> overwrite<span class="token operator">?</span><span class="token operator">:</span> boolean <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>overwrite <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token function">red</span><span class="token punctuation">(</span><span class="token string">&#39;âœ–&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; Operation cancelled&#39;</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> <span class="token keyword">null</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;overwriteChecker&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// åˆ¤æ–­è¾“å…¥çš„é¡¹ç›®åæ˜¯å¦ç¬¦åˆ package.json çš„å‘½åè§„èŒƒ</span>
      <span class="token punctuation">{</span>
        <span class="token function-variable function">type</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token function">isValidPackageName</span><span class="token punctuation">(</span><span class="token function">getProjectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token string">&#39;text&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;packageName&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token string">&#39;Package name:&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function-variable function">initial</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">toValidPackageName</span><span class="token punctuation">(</span><span class="token function">getProjectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function-variable function">validate</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
          <span class="token function">isValidPackageName</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#39;Invalid package.json name&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// é€šè¿‡--templateä¼ å…¥æ¨¡æ¿å­˜åœ¨æ—¶ ä¸è¯¢é—® å¦åˆ™è®©ç”¨æˆ·é€‰æ‹©</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span>
          argTemplate <span class="token operator">&amp;&amp;</span> <span class="token constant">TEMPLATES</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>argTemplate<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token string">&#39;select&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;framework&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span>
          <span class="token keyword">typeof</span> argTemplate <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token constant">TEMPLATES</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>argTemplate<span class="token punctuation">)</span>
            <span class="token operator">?</span> <span class="token function">reset</span><span class="token punctuation">(</span>
                <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>argTemplate<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; isn&#39;t a valid template. Please choose from below: </span><span class="token template-punctuation string">`</span></span>
              <span class="token punctuation">)</span>
            <span class="token operator">:</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token string">&#39;Select a framework:&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">initial</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">choices</span><span class="token operator">:</span> <span class="token constant">FRAMEWORKS</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">framework</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> frameworkColor <span class="token operator">=</span> framework<span class="token punctuation">.</span>color
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token function">frameworkColor</span><span class="token punctuation">(</span>framework<span class="token punctuation">.</span>display <span class="token operator">||</span> framework<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span> framework<span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// åˆ¤æ–­æ¡†æ¶æ˜¯å¦æœ‰å…¶ä»–ç±»å‹ å¦‚æœå­˜åœ¨æ—¶è®©ç”¨æˆ·é€‰æ‹©</span>
      <span class="token punctuation">{</span>
        <span class="token function-variable function">type</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">framework</span><span class="token operator">:</span> Framework</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
          framework <span class="token operator">&amp;&amp;</span> framework<span class="token punctuation">.</span>variants <span class="token operator">?</span> <span class="token string">&#39;select&#39;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;variant&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token string">&#39;Select a variant:&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function-variable function">choices</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">framework</span><span class="token operator">:</span> Framework</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
          framework<span class="token punctuation">.</span>variants<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">variant</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> variantColor <span class="token operator">=</span> variant<span class="token punctuation">.</span>color
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token function">variantColor</span><span class="token punctuation">(</span>variant<span class="token punctuation">.</span>display <span class="token operator">||</span> variant<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token literal-property property">value</span><span class="token operator">:</span> variant<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token function-variable function">onCancel</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token function">red</span><span class="token punctuation">(</span><span class="token string">&#39;âœ–&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; Operation cancelled&#39;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>cancelled<span class="token operator">:</span> any<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cancelled<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
  <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/blog/_assets/debugger-init-noargs.8f24ec02.gif" alt="debugger-init-noargs.gif"></p><p>è¿™ä¸€æ­¥æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>å¦‚æœä¼ å…¥é¡¹ç›®åç§°å’Œæ¨¡æ¿å¹¶è¾“å…¥åˆæ³•æ—¶ï¼Œä¸è¿›è¡Œè¯¢é—®ï¼Œç›´æ¥åˆ°<a href="./.html">ä¸‹ä¸€æ­¥</a>ï¼›</p></li><li><p>æœªä¼ å…¥æ—¶ï¼Œé¦–å…ˆè·å–é¡¹ç›®åï¼›</p></li><li><p>åˆ¤æ–­é¡¹ç›®åæ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨æç¤ºç”¨æˆ·æ˜¯å¦æ¸…ç©ºï¼›</p></li><li><p>ä¸å­˜åœ¨æ—¶ï¼Œåˆ¤æ–­è¾“å…¥é¡¹ç›®åæ˜¯å¦ç¬¦åˆ package.json <a href="https://docs.npmjs.com/cli/v9/configuring-npm/package-json#name" target="_blank" rel="noopener noreferrer">name çš„å‘½åè§„èŒƒ</a>ï¼Œä¸ç¬¦åˆè¦æ±‚ç”¨æˆ·é‡æ–°è¾“å…¥ï¼›</p></li><li><p>ç¬¦åˆæ—¶ï¼Œé€‰æ‹©é¢„è®¾æ¨¡æ¿ä»¥åŠæ¨¡æ¿å¯¹åº”çš„å˜ä½“ï¼Œå¹¶å°†ç”¨æˆ·è¾“å…¥çš„ç»“æœä¿å­˜åˆ°<code>result</code>ä¸­ï¼Œè¿›å…¥<a href="./.html">ä¸‹ä¸€æ­¥</a>ã€‚</p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token punctuation">{</span> framework<span class="token punctuation">,</span> overwrite<span class="token punctuation">,</span> packageName<span class="token punctuation">,</span> variant <span class="token punctuation">}</span> <span class="token operator">=</span> result
</code></pre></div></li></ol><h3 id="è¦†ç›–å·²æœ‰ç›®å½•-åˆ›å»ºä¸å­˜åœ¨çš„é¡¹ç›®ç›®å½•"><a class="header-anchor" href="#è¦†ç›–å·²æœ‰ç›®å½•-åˆ›å»ºä¸å­˜åœ¨çš„é¡¹ç›®ç›®å½•" aria-hidden="true">#</a> è¦†ç›–å·²æœ‰ç›®å½•/åˆ›å»ºä¸å­˜åœ¨çš„é¡¹ç›®ç›®å½•</h3><div class="language-js"><pre><code><span class="token comment">// ç›®å½•æ˜¯å¦ä¸ºç©º æ–‡ä»¶æ•°ä¸º0 æˆ–è€…åªå­˜åœ¨.git</span>
<span class="token keyword">function</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">path</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> files <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
  <span class="token keyword">return</span> files<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token punctuation">(</span>files<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&#39;.git&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// æ¸…ç©ºç›®å½• å¦‚æœæ˜¯.gitæ—¶ ä¸åšå¤„ç†</span>
<span class="token keyword">function</span> <span class="token function">emptyDir</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">dir</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> file <span class="token keyword">of</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>file <span class="token operator">===</span> <span class="token string">&#39;.git&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">continue</span>
    <span class="token punctuation">}</span>
    fs<span class="token punctuation">.</span><span class="token function">rmSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">recursive</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">force</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>cwd<span class="token punctuation">,</span> targetDir<span class="token punctuation">)</span>

<span class="token comment">// è¦†ç›–å·²æœ‰éç©ºç›®å½• æˆ– åˆ›å»ºç©ºç™½ç›®å½•</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>overwrite<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">emptyDir</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  fs<span class="token punctuation">.</span><span class="token function">mkdirSync</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">recursive</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/blog/_assets/mkdirproject.246915ed.gif" alt="mkdirproject.gif"></p><p>è¿™ä¸€æ­¥å®Œæˆåï¼Œå¯ä»¥çœ‹åˆ°åœ¨å½“å‰ç›®å½•å·²ç»åˆ›å»ºäº†<code>vite-project</code>ç©ºç›®å½•ã€‚</p><h3 id="ç¡®å®šæ¨¡æ¿-template"><a class="header-anchor" href="#ç¡®å®šæ¨¡æ¿-template" aria-hidden="true">#</a> ç¡®å®šæ¨¡æ¿ template</h3><p><img src="/blog/_assets/entertemplate.52c9d65c.gif" alt="entertemplate.gif"></p><div class="language-js"><pre><code><span class="token comment">// ç¡®å®šæ¨¡æ¿</span>
<span class="token keyword">let</span> <span class="token literal-property property">template</span><span class="token operator">:</span> string <span class="token operator">=</span> variant <span class="token operator">||</span> framework<span class="token operator">?.</span>name <span class="token operator">||</span> argTemplate
<span class="token keyword">let</span> isReactSwc <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token comment">// æ˜¯å¦åŒ…å«swc https://cn.vitejs.dev/plugins/#vitejsplugin-react-swc</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>template<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;-swc&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  isReactSwc <span class="token operator">=</span> <span class="token boolean">true</span>
  template <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&#39;-swc&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™ä¸€æ­¥ç¡®å®šäº†æœ€ç»ˆé€‰æ‹©çš„æ¨¡æ¿ï¼Œå¹¶ä¸”åˆ¤æ–­äº†æ˜¯å¦æ˜¯ SWC ç±»å‹çš„æ¨¡æ¿ã€‚æ–‡ç« å¼€å¤´æˆ‘ä»¬æé«˜è¿‡ vite4.0 æ”¯æŒ<a href="https://swc.rs/" target="_blank" rel="noopener noreferrer">SWC</a>ï¼Œç±»ä¼¼äºçš„ Babel ä»£ç å¤„ç†æ’ä»¶ï¼ŒåŸºäº Rust å¼€å‘ï¼Œé€Ÿåº¦ä¸Šæ¯” Babel å¿«äº†å¾ˆå¤šå€ï¼Œç›®å‰å®˜æ–¹çš„æ¨¡æ¿ä»…æ”¯æŒåœ¨<a href="https://cn.vitejs.dev/plugins/#vitejsplugin-react-swc" target="_blank" rel="noopener noreferrer">react</a>ä¸­ä½¿ç”¨ã€‚</p><h3 id="ç¡®å®šåŒ…ç®¡ç†å™¨-pkgmanager"><a class="header-anchor" href="#ç¡®å®šåŒ…ç®¡ç†å™¨-pkgmanager" aria-hidden="true">#</a> ç¡®å®šåŒ…ç®¡ç†å™¨ pkgManager</h3><p><img src="/blog/_assets/nodepackage.2720ad09.gif" alt="nodepackage.gif"></p><div class="language-js"><pre><code><span class="token comment">// é€šè¿‡ process.env.npm_config_user_agent è·å–åˆ°å½“å‰è¿è¡Œè„šæœ¬çš„åŒ…ç®¡ç†å™¨å’Œç‰ˆæœ¬å·</span>
<span class="token keyword">function</span> <span class="token function">pkgFromUserAgent</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">userAgent</span><span class="token operator">:</span> string <span class="token operator">|</span> <span class="token keyword">undefined</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>userAgent<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">undefined</span>
  <span class="token keyword">const</span> pkgSpec <span class="token operator">=</span> userAgent<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> pkgSpecArr <span class="token operator">=</span> pkgSpec<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> pkgSpecArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">version</span><span class="token operator">:</span> pkgSpecArr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// process.env.npm_config_user_agent = npm/8.19.3 node/v16.19.1 darwin arm64 workspaces/false</span>
<span class="token keyword">const</span> pkgInfo <span class="token operator">=</span> <span class="token function">pkgFromUserAgent</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>npm_config_user_agent<span class="token punctuation">)</span>
<span class="token comment">// å½“å‰çš„åŒ…ç®¡ç†å™¨</span>
<span class="token keyword">const</span> pkgManager <span class="token operator">=</span> pkgInfo <span class="token operator">?</span> pkgInfo<span class="token punctuation">.</span>name <span class="token operator">:</span> <span class="token string">&#39;npm&#39;</span>
<span class="token comment">// æ˜¯å¦æ˜¯yarn 1.xç‰ˆæœ¬</span>
<span class="token keyword">const</span> isYarn1 <span class="token operator">=</span> pkgManager <span class="token operator">===</span> <span class="token string">&#39;yarn&#39;</span> <span class="token operator">&amp;&amp;</span> pkgInfo<span class="token operator">?.</span>version<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;1.&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>é€šè¿‡è°ƒè¯•ï¼Œå¯ä»¥çŸ¥é“ <code>process.env.npm_config_user_agent</code>æ˜¯<code>npm/8.19.3 node/v16.19.1 darwin arm64 workspaces/false</code>è¿™æ ·çš„æ ¼å¼ï¼Œé€šè¿‡ pkgFromUserAgent å¯ä»¥è·å–åˆ°å½“å‰è¿è¡Œè„šæœ¬çš„åŒ…ç®¡ç†å™¨ï¼ˆnpm/yarn/pnpmï¼‰å’Œç‰ˆæœ¬å·ã€‚</p><h3 id="customcommand-è‡ªå®šä¹‰å‘½ä»¤"><a class="header-anchor" href="#customcommand-è‡ªå®šä¹‰å‘½ä»¤" aria-hidden="true">#</a> customCommand è‡ªå®šä¹‰å‘½ä»¤</h3><p>è¿™é‡Œæˆ‘ä»¬é‡æ–°é€‰ vue æ¨¡æ¿çš„å˜ç§ï¼šcreate-vue è¿›è¡Œè°ƒè¯•</p><p><img src="/blog/_assets/templtae-create-vue.811a39a8.gif" alt="templtae-create-vue.gif"></p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token punctuation">{</span> customCommand <span class="token punctuation">}</span> <span class="token operator">=</span>
  <span class="token constant">FRAMEWORKS</span><span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> f<span class="token punctuation">.</span>variants<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>name <span class="token operator">===</span> template<span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// æ‹¿åˆ°è‡ªå®šä¹‰å‘½ä»¤ å¦‚ï¼šcreate-vue npm create vue@latest TARGET_DIR</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>customCommand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fullCustomCommand <span class="token operator">=</span> customCommand<span class="token operator">...</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>command<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> fullCustomCommand<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">)</span>
  <span class="token comment">// æ›¿æ¢TARGET_DIRä¸ºçœŸå®è·¯å¾„</span>
  <span class="token keyword">const</span> replacedArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> arg<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&#39;TARGET_DIR&#39;</span><span class="token punctuation">,</span> targetDir<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// é€šè¿‡spawn.syncæ‰§è¡Œæ­¤å‘½ä»¤</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> spawn<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> replacedArgs<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// stdio: &#39;inherit&#39;æ„æ€æ˜¯ç»§æ‰¿ï¼šå­è¿›ç¨‹ç»§æ‰¿å½“å‰è¿›ç¨‹çš„è¾“å…¥è¾“å‡º å¹¶å°†è¾“å‡ºä¿¡æ¯åŒæ­¥è¾“å‡ºåœ¨å½“å‰è¿›ç¨‹ä¸Š</span>
    <span class="token literal-property property">stdio</span><span class="token operator">:</span> <span class="token string">&#39;inherit&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// é€€å‡º</span>
  process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span>status <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶æ‹¿åˆ°å¯¹åº”çš„ customCommand è‡ªå®šä¹‰å‘½ä»¤<code>npm create vue@latest TARGET_DIR</code>ï¼Œç„¶åé€šè¿‡<code>spawn.sync</code>å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œå®Œæˆåé€€å‡ºè¿›ç¨‹ã€‚</p><h3 id="è¾“å‡ºæ¨¡æ¿å†…å®¹åˆ°ç›®å½•"><a class="header-anchor" href="#è¾“å‡ºæ¨¡æ¿å†…å®¹åˆ°ç›®å½•" aria-hidden="true">#</a> è¾“å‡ºæ¨¡æ¿å†…å®¹åˆ°ç›®å½•</h3><p>åˆ°æœ€åä¸€æ­¥äº†ï¼ŒåšæŒ âœŠ</p><p><img src="/blog/_assets/generateTemplate.656d0ea6.gif" alt="generateTemplate.gif"></p><div class="language-js"><pre><code><span class="token comment">// ç¡®è®¤æ¨¡æ¿è·¯å¾„</span>
<span class="token keyword">const</span> templateDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>
  <span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// file:///xxx/create-vite-analysis/src/index.ts</span>
  <span class="token string">&#39;../..&#39;</span><span class="token punctuation">,</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">template-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>template<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">)</span>

<span class="token comment">// å†™å…¥æ–‡ä»¶ package.jsonè¦ä¿®æ”¹nameå­—æ®µä½¿ç”¨writeFileSync å…¶ä»–ç›´æ¥copy</span>
<span class="token keyword">const</span> <span class="token function-variable function">write</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">file</span><span class="token operator">:</span> string<span class="token punctuation">,</span> content<span class="token operator">?</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> targetPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> renameFiles<span class="token punctuation">[</span>file<span class="token punctuation">]</span> <span class="token operator">??</span> file<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>targetPath<span class="token punctuation">,</span> content<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¤åˆ¶æ–‡ä»¶/æ–‡ä»¶å¤¹</span>
    <span class="token function">copy</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>templateDir<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">,</span> targetPath<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// è·å–æ¨¡æ¿ä¸‹çš„æ–‡ä»¶ å°†é™¤äº†package.jsonçš„æ–‡ä»¶å…¨éƒ¨å¤åˆ¶åˆ°è¾“å‡ºç›®å½•ä¸­</span>
<span class="token keyword">const</span> files <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>templateDir<span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> file <span class="token keyword">of</span> files<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> f <span class="token operator">!==</span> <span class="token string">&#39;package.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">write</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// é€šè¿‡readFileSyncæ‹¿åˆ°package.jsonæ–‡ä»¶å†…å®¹ å¹¶é€šè¿‡JSON.parseå¤„ç†</span>
<span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>
  fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>templateDir<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">package.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment">// æ›¿æ¢nameä¸ºé¡¹ç›®åç§°</span>
pkg<span class="token punctuation">.</span>name <span class="token operator">=</span> packageName <span class="token operator">||</span> <span class="token function">getProjectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&#39;package.json&#39;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>pkg<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;\n&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// é€‰æ‹©çš„æ˜¯react swcæ¨¡æ¿æ—¶ æ›¿æ¢æ’ä»¶</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>isReactSwc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setupReactSwc</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> template<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&#39;-ts&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// è¾“å‡º</span>
<span class="token comment">// cd ...</span>
<span class="token comment">// npm install</span>
<span class="token comment">// npm run dev</span>
</code></pre></div><p>å¤§æ¦‚æµç¨‹ä¸ºï¼š</p><ol><li><p>é€šè¿‡æœ€ç»ˆæ¨¡æ¿ <code>template</code> ç¡®è®¤æ¨¡æ¿å¯¹åº”çš„ç›®å½•ï¼Œä¹Ÿå°±æ˜¯è¿™äº›æ–‡ä»¶å¤¹ï¼› <img src="/blog/_assets/viteTemplateList.69e42bd5.png" alt="viteTemplateList.png"></p><p>æ­¤å¤„<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/import.meta" target="_blank" rel="noopener noreferrer">import.meta</a>å¯ä»¥è·å–è¿™ä¸ªæ¨¡å—çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œ<code>import.meta.url</code>ç›¸å½“äº<code>file:///Users/xxx/create-vite-analysis/src/index.ts</code></p></li><li><p>è·å–æ¨¡æ¿å†…çš„æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼Œé€šè¿‡<code>write</code>å‡½æ•°å°†é™¤äº† package.json çš„æ–‡ä»¶å…¨éƒ¨å¤åˆ¶åˆ°è¾“å‡ºç›®å½•<code>targetPath</code>ä¸­ï¼›</p></li><li><p>å°† package.json æ–‡ä»¶çš„<code>name</code>å­—æ®µæ›¿æ¢ä¸ºé¡¹ç›®å<code>packageName || getProjectName()</code>ï¼Œå¹¶å†™å…¥è¾“å‡ºç›®å½•ä¸­ï¼›</p></li><li><p>æ­¤æ—¶è¿˜éœ€è¦åˆ¤æ–­æ˜¯å¦ä¸º react SWC æ¨¡å¼ï¼Œå¦‚æœæ˜¯çš„è¯æ›¿æ¢ç›¸åº”çš„æ’ä»¶ä¸º SWC çš„æ’ä»¶ã€‚</p></li></ol><p>æœ€åï¼Œè¾“å‡º<code>cd ...</code>è¿™äº›æç¤ºå‘½ä»¤ã€‚</p><h2 id="æ€»ç»“"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h2><p>create-vite çš„æºç æˆ‘ä»¬å·²ç»è°ƒè¯•å®Œäº†ï¼Œæ˜¯ä¸æ˜¯æœ‰è¿™ç§æ„Ÿè§‰ï¼š<strong>åŸæ¥ç¦»æˆ‘ä»¬é¥ä¸å¯åŠçš„æºç ï¼Œå¹¶æ²¡é‚£ä¹ˆé«˜æ·±è«æµ‹</strong>ï¼Œå¦‚æœè‡ªå·±åŠ¨æ‰‹è°ƒè¯•ä¸€ä¸‹çš„è¯ï¼Œä¼šå‘ç°å¹¶æ²¡æœ‰é‚£ä¹ˆéš¾ã€‚</p><p>è¯´ä¸‹æˆ‘è‡ªå·±çš„æ”¶è·ï¼š</p><ol><li>çŸ¥é“äº† vite4.0 çš„æ–°åŠŸèƒ½ï¼Œäº†è§£äº†ä¸€ä¸‹ SWC ä¸ Babel çš„å¯¹æ¯”ï¼›</li><li>å­¦åˆ°äº† npm init/create å‘½ä»¤æ‰§è¡Œçš„è¿‡ç¨‹ä»¥åŠ npx ä¸ npm exec çš„åŒºåˆ«ï¼›</li><li>å­¦ä¼šäº† koloristã€promptsã€minimistã€cross-spawn è¿™å‡ ä¸ªå·¥å…·çš„ä½¿ç”¨ï¼›</li><li>å­¦ä¼šäº† vscode å¦‚ä½•è°ƒè¯• ts ä»£ç ï¼›</li><li>å­¦ä¼šäº† è„šæ‰‹æ¶å·¥å…· åˆ›å»ºé¡¹ç›®çš„æµç¨‹ï¼Œæœ‰æœºä¼šçš„è¯ä¸ºå…¬å¸å¼„ä¸€å¥—è‡ªå·±çš„è„šæ‰‹æ¶ create-xxxã€‚</li></ol><p>æˆ‘å‘ç°æœ‰å¾ˆå¤šäººæ˜¯ä¼šè¢«è‡ªå·±åŠé€€ï¼Œ&quot;æˆ‘è¿™ç§æ°´å¹³æ€ä¹ˆè¯»å¾—äº†æºç &quot;ã€&quot;æˆ‘è¿˜æ²¡åˆ°è¯»æºç çš„å¹´é™&quot;è¯¸å¦‚æ­¤ç±»çš„è¯ï¼Œä¸å¦¨åŠ¨æ‰‹ä»ç®€å•çš„æºç è¯•è¯•ï¼Œä½ å¹¶æ²¡æœ‰è‡ªå·±æƒ³çš„é‚£ä¹ˆç³Ÿç³•ï¼ˆå“ˆå“ˆï¼Œæˆ‘å°±æ˜¯ä¸ª ğŸŒ°ï¼‰ï¼Œ</p><p>æœ‰å…´è¶£å°±æ¥å‚åŠ <a href="https://juejin.cn/post/7079706017579139102" target="_blank" rel="noopener noreferrer">ç”±å…¬ä¼—å·@è‹¥å·è§†é‡å‘èµ·çš„ï¼Œæ¯å‘¨å¤§å®¶ä¸€èµ·å­¦ä¹  200 è¡Œå·¦å³çš„æºç å…±è¯»æ´»åŠ¨</a>ï¼Œä¸€èµ·è¿›æ­¥å§ã€‚</p><p>æœ¬æ–‡é¡¹ç›®åœ°å€ï¼Œgit clone <a href="https://github.com/wang1xiang/create-vite-analysis.git%E3%80%82%E6%AC%A2%E8%BF%8E" target="_blank" rel="noopener noreferrer">https://github.com/wang1xiang/create-vite-analysis.gitã€‚æ¬¢è¿</a> starã€‚</p></div><div class="links-wrapper"><div class="prev-link"><!----></div><div class="next-link"><!----></div></div><div><footer class="page-edit"><!-- <a v-for="(item,index) in data.platform" :key="index" :href="item.href">
        <img class="imgIcon" :src="item.icon" />
      </a> --></footer><!-- <p class="platform">
      ä»¥ä¸Šçš†ä¸º
      <a href="javascript:;">çºªå¹´</a> æ–‡ç« å‘å¸ƒå¹³å°
    </p> --><p class="platform"><a href="https://beian.miit.gov.cn/" target="_blank">äº¬ICPå¤‡2022027737å·</a><br> Copyright Â© 2022 - present <a href="https://github.com/wang1xiang">@wangxiang</a></p></div><!--[--><!--]--></div><!-- åªæƒ³ç‚¹å‡»èƒŒæ™¯æ‰å…³é—­ è¯·ä½¿ç”¨ .self ä¿®é¥°ç¬¦ --><div style="display:none;" class="imgBox"><img src=""></div><!--]--></main><div class="theme-select" data-v-afcf09d4><ul data-v-afcf09d4><li class="active" data-v-afcf09d4>â˜€ï¸</li><li class="" data-v-afcf09d4>ğŸŒ‘</li></ul></div></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"README.md\":\"373b96a3\",\"index.md\":\"3ff3726d\",\"more_docs.md\":\"9d986a98\",\"more_index.md\":\"71381de5\",\"more_tags.md\":\"7456380c\",\"docs_css_grid.md\":\"6a6a1315\",\"docs_css_placeholder.md\":\"1e9556b2\",\"docs_css_tailWindcss-start.md\":\"6e2c1bb6\",\"docs_docker_docker-start.md\":\"f7cd4ce6\",\"docs_electron_electron-bug.md\":\"2133baba\",\"docs_electron_electron-check-update.md\":\"98d4baf8\",\"docs_electron_electron-diaoyan.md\":\"f458d149\",\"docs_electron_electron-object-destroyed.md\":\"975e0195\",\"docs_electron_electron-og.md\":\"fd8b396a\",\"docs_electron_electron-open-other.md\":\"f3ac1742\",\"docs_electron_electron-protocol.md\":\"e7064f81\",\"docs_electron_electron-sentry.md\":\"de6f0260\",\"docs_electron_electron-sign-windows.md\":\"52b389cb\",\"docs_electron_electron-sign.md\":\"6f579090\",\"docs_electron_electron-sqlite3-bug.md\":\"f334bc6c\",\"docs_electron_electron-sqlite3-start.md\":\"a54407ef\",\"docs_electron_electron-sqlite3.md\":\"7fa3d3f8\",\"docs_electron_electron-start.md\":\"4c34abee\",\"docs_electron_electron-update.md\":\"35f47033\",\"docs_electron_electron-webview-zoom.md\":\"98651e6f\",\"docs_electron_hybrid-electron.md\":\"37557334\",\"docs_electron_sentry-electron.md\":\"fee9b600\",\"docs_flutter_flutter-dart.md\":\"7174c581\",\"docs_flutter_flutter-other.md\":\"272dc22c\",\"docs_flutter_flutter-route-manage.md\":\"29ba19f3\",\"docs_flutter_flutter-start.md\":\"bbbc8b59\",\"docs_flutter_flutter-state-manage.md\":\"3450ac3c\",\"docs_flutter_flutter-wechat-pay.md\":\"d1835255\",\"docs_git_git-autocrlf.md\":\"c45faa1b\",\"docs_git_git-ignorecase.md\":\"300120b0\",\"docs_git_git-notes.md\":\"e256f944\",\"docs_git_git-rebase.md\":\"e0a5ad39\",\"docs_git_git-username.md\":\"f4af7e64\",\"docs_git_gitflow.md\":\"42234ed5\",\"docs_git_gitlab-ci-start.md\":\"9ddd504e\",\"docs_http_http.md\":\"1bdf2e10\",\"docs_javascript_async-await.md\":\"0b8fa8d1\",\"docs_javascript_createEvent.md\":\"49ebda2a\",\"docs_javascript_html2docs.md\":\"e94e8757\",\"docs_javascript_http-cache.md\":\"9087546b\",\"docs_javascript_image-load.md\":\"6c30b9ba\",\"docs_javascript_indexDB-dexie.md\":\"3f3d886e\",\"docs_javascript_javascript-utils.md\":\"6b591c98\",\"docs_javascript_memory-leak.md\":\"e0ee970b\",\"docs_javascript_office-preview-type.md\":\"28ca6ccb\",\"docs_javascript_page-alive.md\":\"96bcc34d\",\"docs_javascript_performance-optimization.md\":\"c3c58b7d\",\"docs_javascript_preload-prefetch.md\":\"1d37d375\",\"docs_javascript_scrollend.md\":\"b7400869\",\"docs_javascript_storage-change.md\":\"636dfd98\",\"docs_javascript_turborepo-start.md\":\"ad3fc91f\",\"docs_javascript_webworker.md\":\"5c63c39f\",\"docs_javascript_zero-width-space.md\":\"c06a054a\",\"docs_leetcode_array-code.md\":\"604d8129\",\"docs_leetcode_array-code1.md\":\"2c2e32c9\",\"docs_leetcode_back-tracking-code.md\":\"25701482\",\"docs_leetcode_back-tracking-code1.md\":\"a17cbb2c\",\"docs_leetcode_back-tracking-code2.md\":\"32f6a521\",\"docs_leetcode_back-tracking-code3.md\":\"367f57b7\",\"docs_leetcode_binary-tree-code.md\":\"afffc309\",\"docs_leetcode_binary-tree-code1.md\":\"f2a9ef4e\",\"docs_leetcode_binary-tree-code2.md\":\"f487c1a2\",\"docs_leetcode_binary-tree-code3.md\":\"f8cea384\",\"docs_leetcode_binary-tree-code4.md\":\"3921d8f1\",\"docs_leetcode_binary-tree-code5.md\":\"59327f69\",\"docs_leetcode_binary-tree-code6.md\":\"ac41c950\",\"docs_leetcode_binary-tree-code7.md\":\"bbf06815\",\"docs_leetcode_dynamic-programming-code.md\":\"7bc1dff5\",\"docs_leetcode_dynamic-programming-code2.md\":\"e6bc7a70\",\"docs_leetcode_greedy-algorithmc-code.md\":\"376bef3f\",\"docs_leetcode_greedy-algorithmc-code2.md\":\"a7a25f32\",\"docs_leetcode_greedy-algorithmc-code3.md\":\"ad6a6411\",\"docs_leetcode_greedy-algorithmc-code4.md\":\"1d37403d\",\"docs_leetcode_greedy-algorithmc-code5.md\":\"ba6810e7\",\"docs_leetcode_hash-code.md\":\"ed219e31\",\"docs_leetcode_hash-code1.md\":\"90649e7a\",\"docs_leetcode_linked-list-code.md\":\"062c8ac5\",\"docs_leetcode_linked-list-code1.md\":\"acdaf1cb\",\"docs_leetcode_stack-code.md\":\"169a13aa\",\"docs_leetcode_stack-code1.md\":\"1e307560\",\"docs_leetcode_string-code.md\":\"b48537cb\",\"docs_leetcode_string-code1.md\":\"04ed819b\",\"docs_linux_centos-docker.md\":\"b68ccab9\",\"docs_linux_linux-no-possword.md\":\"68377395\",\"docs_mobile_mobileDebugging.md\":\"22a80af1\",\"docs_nest_mysql-satart.md\":\"f6b60c17\",\"docs_nest_nest-bff.md\":\"c8207837\",\"docs_nest_nest-start.md\":\"7eb68efc\",\"docs_node_bff-express-esm.md\":\"2fd220ab\",\"docs_node_bff-express.md\":\"874b9052\",\"docs_node_bff.md\":\"fec733f2\",\"docs_node_deploy-server.md\":\"ddb5ab3e\",\"docs_node_express-mysql2.md\":\"d037a043\",\"docs_node_express-swigger.md\":\"af275197\",\"docs_node_socketIO-start.md\":\"7b92d355\",\"docs_photography_nd.md\":\"45957436\",\"docs_pnpm_pnpm-monorepo.md\":\"cceef4a4\",\"docs_prosemirror_html2docs-pdf.md\":\"ad763948\",\"docs_react_create-react-app.md\":\"cf0facdf\",\"docs_react_dompurify.md\":\"5569ac28\",\"docs_react_eslint-react.md\":\"75391bd8\",\"docs_react_react-classnames.md\":\"acfafbcb\",\"docs_react_react-grid-layout.md\":\"9bbf54a1\",\"docs_react_react-intl.md\":\"b2f8b9f0\",\"docs_react_react-philosophies.md\":\"8c1bc9cd\",\"docs_react_react-query.md\":\"eb9b432d\",\"docs_react_react-router-change.md\":\"3036b21a\",\"docs_react_react-vs-vue3.md\":\"364468ae\",\"docs_react_redux-audition.md\":\"ab202e50\",\"docs_react_tomcat-404.md\":\"4ed67d4a\",\"docs_reactNative_react-native-errors.md\":\"ffcd47d3\",\"docs_taro_taro-get-started.md\":\"5e28b8c3\",\"docs_taro_taro-start.md\":\"592187ed\",\"docs_tiptap_tiptap-tutorial.md\":\"1a5640fd\",\"docs_tiptap_tiptap-tutorial10.md\":\"cb3a36b8\",\"docs_tiptap_tiptap-tutorial2.md\":\"d583af49\",\"docs_tiptap_tiptap-tutorial3.md\":\"007d2c88\",\"docs_tiptap_tiptap-tutorial4.md\":\"603026cc\",\"docs_tiptap_tiptap-tutorial5.md\":\"0bf99c1e\",\"docs_tiptap_tiptap-tutorial6.md\":\"f1baa096\",\"docs_tiptap_tiptap-tutorial7.md\":\"29d15edd\",\"docs_tiptap_tiptap-tutorial8.md\":\"101eb937\",\"docs_tiptap_tiptap-tutorial9.md\":\"5ba4c1d6\",\"docs_tool_2023-summary.md\":\"524950b7\",\"docs_tool_2024-summary.md\":\"bde49e13\",\"docs_tool_blog.md\":\"dd744b1b\",\"docs_tool_chatgpt.md\":\"45580cc5\",\"docs_tool_chrome-extension.md\":\"b01e71f3\",\"docs_tool_chrome-override.md\":\"e311627f\",\"docs_tool_debugging.md\":\"168bd276\",\"docs_tool_mac.md\":\"485d9b77\",\"docs_tool_mock.md\":\"502496f4\",\"docs_tool_moment-api.md\":\"2f5cbc00\",\"docs_tool_mvp.md\":\"581443d5\",\"docs_tool_np.md\":\"a04e3f15\",\"docs_tool_prosemirror-tables.md\":\"9f578a8f\",\"docs_tool_vitepress-error.md\":\"daabb2e9\",\"docs_tool_vscode-web-error.md\":\"041eca08\",\"docs_tool_whistle.md\":\"6a8f46a1\",\"docs_tool_yarn-certificate.md\":\"fb9c0740\",\"docs_vite_componentLibrary.md\":\"58a0d869\",\"docs_vite_create-vite.md\":\"35b04b3d\",\"docs_vite_vite-env.md\":\"5663d6d5\",\"docs_vite_vite-mulit-import.md\":\"8a0c5dc4\",\"docs_vite_vite-react-cli.md\":\"dccab41a\",\"docs_vite_vite-react.md\":\"658e9cd0\",\"docs_vite_vite.md\":\"b5b230d1\",\"docs_vite_vite3.0.md\":\"ae9ff8b3\",\"docs_vscode_vscode-markdown.md\":\"7a791289\",\"docs_vscode_vscode-todo.md\":\"1b3b2547\",\"docs_vue_antd-form.md\":\"20ce24f7\",\"docs_vue_antd-vue.md\":\"e34fadb9\",\"docs_vue_axios-token.md\":\"56553353\",\"docs_vue_history-mode.md\":\"c2a7b372\",\"docs_vue_keepAlive.md\":\"7748dbfd\",\"docs_vue_tjTodo.md\":\"03fac647\",\"docs_vue_unplugin-auto-import.md\":\"1d1c3da7\",\"docs_vue_vue-scoped-issue.md\":\"8734daad\",\"docs_vue_vue3-jsx.md\":\"80a0f93b\",\"docs_vue_vue3-lint-staged.md\":\"87675a34\",\"docs_vue_vue3-unexpected-token.md\":\"dc8a1266\",\"docs_webrtc_getstarted-webrtc.md\":\"e610a37a\",\"docs_webrtc_livekit-start.md\":\"02610fdf\",\"docs_webrtc_webrtc-one.md\":\"a86aa9d0\",\"docs_wechat_uniapp-start.md\":\"f9c809a0\",\"docs_wechat_wechat-app.md\":\"393fed02\",\"docs_work_360-develop.md\":\"7f7bab9a\",\"docs_work_babel.md\":\"6523fa0d\",\"docs_work_click-event.md\":\"beb9ef48\",\"docs_work_contentEdit-div-insert.md\":\"06311d2b\",\"docs_work_developer.md\":\"3115b26b\",\"docs_work_echarts.md\":\"4e945f8f\",\"docs_work_email-font.md\":\"6024f229\",\"docs_work_excalidraw-use.md\":\"e94ecb3a\",\"docs_work_excalidraw.md\":\"5fdaaef3\",\"docs_work_font-loading-speed.md\":\"d37e04e5\",\"docs_work_g2-vs-echarts.md\":\"c5ae6ce5\",\"docs_work_h5-app.md\":\"3e353e1c\",\"docs_work_html2canvas-bug.md\":\"5a23b282\",\"docs_work_i18n.md\":\"6eafa6d3\",\"docs_work_image-type.md\":\"20f1b055\",\"docs_work_jenkins-start.md\":\"5702127a\",\"docs_work_js-long.md\":\"ce8b0904\",\"docs_work_malformed.md\":\"08ef09c6\",\"docs_work_mutationObserver.md\":\"1e2b6f46\",\"docs_work_node16-docker.md\":\"6d167e40\",\"docs_work_one-react-screenshots.md\":\"fa15cb29\",\"docs_work_plop-express.md\":\"2d5aa780\",\"docs_work_puppeteer.md\":\"e3884813\",\"docs_work_react-ref.md\":\"018e968f\",\"docs_work_report-2023.md\":\"3573d9a6\",\"docs_work_report-regular.md\":\"4cae6fcb\",\"docs_work_richeditor.md\":\"ed767a1f\",\"docs_work_sentry-cli-error.md\":\"a09b2a8e\",\"docs_work_sentry-error.md\":\"f8d96600\",\"docs_work_sentry.md\":\"9f318c1c\",\"docs_work_server-deploy.md\":\"5d7c6e9e\",\"docs_work_sse.md\":\"57ec9cfd\",\"docs_work_text-decoration.md\":\"c174c380\",\"docs_work_unocss.md\":\"90691e9d\",\"docs_work_white-board.md\":\"ce54933d\",\"docs_work_word-cpu.md\":\"1df1ba35\",\"docs_work_zero-width-spaces.md\":\"826a4384\"}")</script>
    <script type="module" async src="/blog/_assets/app.41c738e0.js"></script>
  </body>
</html>