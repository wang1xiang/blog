import{f as s,g as n,J as a}from"./common-03e46d7f.js";const t='{"title":"Yjs 使用报错","frontmatter":{"date":"2024-04-01","title":"Yjs 使用报错","tags":["tiptap"],"describe":"tiptap-tutorial8"},"headers":[{"level":2,"title":"问题","slug":"问题"}],"relativePath":"docs/tiptap/tiptap-tutorial8.md","lastUpdated":1742176930176.5977}';var p={};const e=[a('<h2 id="问题"><a class="header-anchor" href="#问题" aria-hidden="true">#</a> 问题</h2><ol><li><p>报错 Yjs was already imported. This breaks constructor checks and will lead to issues!</p><p>通过 <a href="https://github.com/yjs/yjs/issues/438" target="_blank" rel="noopener noreferrer">issue</a>得知：出现此消息的另原因是项目的某些部分使用了 Yjs 的 cjs 版本，而某些部分使用 Yjs 的 es 版本。</p><p>当更新依赖它的 yjs 或库时，我们经常遇到这个错误。特别是在翻新更新拉取请求中。对我们来说，解决方案很简单：检查您的 yarn.lock 或 package-lock.json 是否有多个条目！</p><p><a href="https://github.com/facebook/lexical/issues/2153" target="_blank" rel="noopener noreferrer">解决方案</a></p><p>仅仅只需要添加别名即可。</p><div class="language-js"><pre><code><span class="token comment">// https://vitejs.dev/config/</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">react</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token literal-property property">yjs</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;./node_modules/yjs/src/index.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><p>有时会安装嵌套的 yjs 包。可能地，node_modules 中可以有嵌套的 yjs 安装：例如节点模块 &amp; 节点模块/@lexical/yjs/节点模块/yjs)。</p><p>出现错误消息的另一个原因是某些复杂的构建系统同时导入 Yjs 的 commonjs (.cjs) 和模块 (.mjs) 版本。</p><p>您可以通过明确指定要使用的版本来解决这两个问题。在 webpack 和其他捆绑器中，您可以设置别名：yjs: &quot;node_modules/yjs/dist/yjs.mjs&quot;。</p><p>vite 配置中的别名建议解决了重复导入的错误。</p></li><li></li><li></li></ol>',2)];p.render=function(a,t,p,o,l,c){return s(),n("div",null,e)};export{t as __pageData,p as default};
