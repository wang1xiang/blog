import{f as n,g as a,J as s}from"./common-03e46d7f.js";const p='{"title":"Taro入门——快速上手","frontmatter":{"date":"2023-11-16","title":"Taro入门——快速上手","tags":["taro"],"describe":"taro-get-started"},"headers":[{"level":2,"title":"开发环境准备","slug":"开发环境准备"},{"level":2,"title":"初始化项目","slug":"初始化项目"},{"level":3,"title":"入口组件","slug":"入口组件"},{"level":3,"title":"全局配置","slug":"全局配置"},{"level":3,"title":"页面组件","slug":"页面组件"},{"level":2,"title":"项目运行","slug":"项目运行"},{"level":2,"title":"TodoMVC：万变不离其宗","slug":"todomvc：万变不离其宗"}],"relativePath":"docs/taro/taro-get-started.md","lastUpdated":1704958632156.5154}';var t={};const o=[s('<p>最快的上手方式就是开发一个简单的项目，然后有问题了再去查文档。</p><h2 id="开发环境准备"><a class="header-anchor" href="#开发环境准备" aria-hidden="true">#</a> 开发环境准备</h2><p>目前 Taro 仅提供一种开发方式：安装 Taro 命令行工具（Taro CLI）进行开发。</p><div class="language-bash"><pre><code><span class="token comment"># 全局安装 Taro CLI</span>\n<span class="token function">npm</span> i -g @tarojs/cli\n<span class="token comment"># 不安装直接使用</span>\n$ npx @tarojs/cli init myApp\n</code></pre></div><p>安装完成后，输入<code>taro</code>出现如下提示，则安装成功 <img src="/blog/_assets/taro-install.e75bd19d.png" alt="taro-install"></p><h2 id="初始化项目"><a class="header-anchor" href="#初始化项目" aria-hidden="true">#</a> 初始化项目</h2><p>直接使用 Taro 脚手架工具初始化一个 Taro 项目：</p><p><img src="/blog/_assets/taro-init.0ed862ca.png" alt="taro-init.png"></p><p>选择模板：在创建项目时，Taro 会提示您选择一个模板。根据您的需求选择适合的模板，这里以微信小程序为例，选择微信小程序模板。</p><div class="language-bash"><pre><code>├── __test__                    <span class="token comment"># 测试</span>\n├── config                      <span class="token comment"># 编译配置目录</span>\n│   ├── dev.js                  <span class="token comment"># 开发模式配置</span>\n│   ├── index.js                <span class="token comment"># 默认配置</span>\n│   └── prod.js                 <span class="token comment"># 生产模式配置</span>\n├── dist                        <span class="token comment"># 打包目录</span>\n├── src <span class="token comment"># 源码目录</span>\n│   ├── app.config.ts           <span class="token comment"># 全局配置</span>\n│   ├── app.scss                <span class="token comment"># 全局 CSS</span>\n│   ├── app.ts                  <span class="token comment"># 入口组件</span>\n│   ├── index.html              <span class="token comment"># H5 入口 HTML</span>\n│   └── pages                   <span class="token comment"># 页面组件</span>\n│       └── index\n│           ├── index.config.ts <span class="token comment"># 页面配置</span>\n│           ├── index.scss      <span class="token comment"># 页面 CSS</span>\n│           └── index.tsx       <span class="token comment"># 页面组件，如果是 Vue 项目，此文件为 index.vue</span>\n├── types                       <span class="token comment"># ts声明</span>\n├── .env                        <span class="token comment"># 环境变量</span>\n├── .eslintrc.js                <span class="token comment"># ESLint 配置</span>\n├── babel.config.js             <span class="token comment"># Babel 配置</span>\n├── package.json                <span class="token comment"># Node.js manifest</span>\n├── project.config.json         <span class="token comment"># 微信小程序项目配置</span>\n├── project.tt.json             <span class="token comment"># 头条小程序项目配置</span>\n\n</code></pre></div><p><strong>dist 目录</strong></p><p>根据命令选择的终端，编译成特定代码，如使用 yarn dev:h5 则生成 web 的代码，使用 yarn dev:weapp 则会生成小程序代码，并且<strong>每次执行都会删除之前的代码</strong>。</p><h3 id="入口组件"><a class="header-anchor" href="#入口组件" aria-hidden="true">#</a> 入口组件</h3><p>Taro 项目入口组件<strong>用于注册应用</strong>，默认为<code>src/app.ts</code>。在入口文件中可以设置全局状态或访问小程序入口实例的生命周期等。</p><div class="language-js"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> PropsWithChildren <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>\n<span class="token comment">// Taro 额外添加的 hooks</span>\n<span class="token keyword">import</span> <span class="token punctuation">{</span> useLaunch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@tarojs/taro&#39;</span>\n<span class="token keyword">import</span> <span class="token string">&#39;./app.scss&#39;</span>\n\n<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token operator">:</span> PropsWithChildren<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token function">useLaunch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;App launched.&#39;</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token comment">// children 是将要会渲染的页面</span>\n  <span class="token keyword">return</span> children\n<span class="token punctuation">}</span>\n\n<span class="token keyword">export</span> <span class="token keyword">default</span> App\n</code></pre></div><p>入口组件可以使用小程序的生命周期：</p><ul><li><p>onLaunch</p><p>在小程序环境中对应 app 的 onLaunch。<a href="https://docs.taro.zone/docs/react-entry/#onlaunch-options" target="_blank" rel="noopener noreferrer">详细参数</a></p><p>Taro Hooks 中使用 useLaunch 代替 onLaunch</p></li><li><p>onError</p><p>小程序发生脚本错误或 API 调用报错时触发。</p><p>Taro Hooks 中使用 useError 代替 onError</p></li><li><p>componentDidShow</p><p>程序启动，或切前台时触发。</p></li><li><p>componentDidHide</p><p>程序切后台时触发。</p></li><li><p>onPageNotFound</p><p>小程序页面找不到时。</p><p>Taro Hooks 中使用 usePageNotFound 代替 onPageNotFound</p></li></ul><p>更多请查看<a href="https://docs.taro.zone/docs/hooks#taro-hooks" target="_blank" rel="noopener noreferrer">Taro Hooks</a></p><h3 id="全局配置"><a class="header-anchor" href="#全局配置" aria-hidden="true">#</a> 全局配置</h3><p><code>src/app.config.ts</code> 文件用来对小程序进行全局配置，配置项遵循微信小程序规范，并且对所有平台进行统一。</p><p>用于设置页面组件的路径、全局窗口、路由等信息，一个最简单的全局配置如下：</p><p>使用编译时宏函数 defineAppConfig 包裹配置对象，以获得类型提示和自动补全。</p><div class="language-js"><pre><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineAppConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// 页面路径列表</span>\n  <span class="token literal-property property">pages</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;pages/index/index&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token comment">// 全局的默认窗口表现</span>\n  <span class="token literal-property property">window</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">backgroundTextStyle</span><span class="token operator">:</span> <span class="token string">&#39;light&#39;</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">navigationBarBackgroundColor</span><span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">navigationBarTitleText</span><span class="token operator">:</span> <span class="token string">&#39;WeChat&#39;</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">navigationBarTextStyle</span><span class="token operator">:</span> <span class="token string">&#39;black&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// 底部 tab 栏的表现</span>\n  <span class="token literal-property property">tabBar</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// 分包结构配置</span>\n  <span class="token literal-property property">subPackages</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><ul><li><p>pages</p><p>用于指定小程序由哪些页面组成，每一项都对应一个页面的 <code>路径 + 文件名</code> 信息。数组的<strong>第一项代表小程序的初始页面</strong>（首页）。 新增/减少页面，都需要对 pages 数组进行修改。</p></li><li><p>window</p><p>用于设置小程序的状态栏、导航条、标题、窗口背景色。<a href="https://docs.taro.zone/docs/app-config/#window" target="_blank" rel="noopener noreferrer">详细配置</a></p></li><li><p>tabBar</p><p>通过 tabBar 配置项指定 tab 栏的表现，以及 tab 切换时显示的对应页面。</p></li></ul><p>配置规范基于微信小程序的全局配置进行制定，所有平台进行统一。在配置文件中，Taro 并不关心框架的区别，Taro CLI 会直接在编译时在 Node.js 环境直接执行全局配置的代码，并把 export default 导出的对象序列化为一个 JSON 文件。</p><p><strong>因此，必须保证配置文件是在 Node.js 环境中是可以执行的，不能使用一些在 H5 环境或小程序环境才能运行的包或者代码，否则编译将会失败。</strong></p><h3 id="页面组件"><a class="header-anchor" href="#页面组件" aria-hidden="true">#</a> 页面组件</h3><p>页面组件默认放在<code>src/pages</code>下，配置在全局配置中的<code>pages</code>中，通过 Taro 路由进行跳转，一个 Taro 应用至少有一个页面组件。</p><p>与 React 组件相比，Taro 中我们需要使用<code>@tarojs/components</code>的提供的<a href="https://docs.taro.zone/docs/components-desc/" target="_blank" rel="noopener noreferrer">跨平台组件</a><code>View</code>、<code>Text</code>等进行开发。</p><h4 id="生命周期"><a class="header-anchor" href="#生命周期" aria-hidden="true">#</a> 生命周期</h4><p>页面组件除了支持 React 的生命周期方法外，还根据小程序的标准，额外支持<a href="https://docs.taro.zone/docs/react-page/#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%96%B9%E6%B3%95" target="_blank" rel="noopener noreferrer">以下生命周期</a></p><h4 id="页面配置"><a class="header-anchor" href="#页面配置" aria-hidden="true">#</a> 页面配置</h4><p>与入口组件一样，也存在一个页面配置文件<code>index.config.ts</code>，用于设置当前页面的导航栏、背景颜色等，页面中配置项在当前页面会覆盖全局配置的 <code>window</code> 中相同的配置项。</p><p>使用编译时宏函数 definePageConfig 包裹配置对象，以获得类型提示和自动补全。</p><div class="language-js"><pre><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">definePageConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token literal-property property">navigationBarTitleText</span><span class="token operator">:</span> <span class="token string">&#39;首页&#39;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre></div><h4 id="快捷命令"><a class="header-anchor" href="#快捷命令" aria-hidden="true">#</a> 快捷命令</h4><p>使用命令</p><div class="language-bash"><pre><code>Taro create --name xxx\n</code></pre></div><p>可以快速创建页面组件，并填充基础代码</p><h2 id="项目运行"><a class="header-anchor" href="#项目运行" aria-hidden="true">#</a> 项目运行</h2><p>Taro CLI 生成的<code>package.json</code>文件中提供了多种命令</p><div class="language-json"><pre><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n  <span class="token property">&quot;build:weapp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;taro build --type weapp&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;build:swan&quot;</span><span class="token operator">:</span> <span class="token string">&quot;taro build --type swan&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;build:alipay&quot;</span><span class="token operator">:</span> <span class="token string">&quot;taro build --type alipay&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;build:tt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;taro build --type tt&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;build:h5&quot;</span><span class="token operator">:</span> <span class="token string">&quot;taro build --type h5&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;build:rn&quot;</span><span class="token operator">:</span> <span class="token string">&quot;taro build --type rn&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;build:qq&quot;</span><span class="token operator">:</span> <span class="token string">&quot;taro build --type qq&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;build:jd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;taro build --type jd&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;build:quickapp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;taro build --type quickapp&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dev:weapp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:weapp -- --watch&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dev:swan&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:swan -- --watch&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dev:alipay&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:alipay -- --watch&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dev:tt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:tt -- --watch&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dev:h5&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:h5 -- --watch&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dev:rn&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:rn -- --watch&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dev:qq&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:qq -- --watch&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dev:jd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:jd -- --watch&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dev:quickapp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:quickapp -- --watch&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest&quot;</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\n</code></pre></div><p>Taro 编译分为 dev 和 build 模式：</p><ul><li>dev 模式（增加 --watch 参数） 将会监听文件修改，执行<code>taro build --type xxx --watch</code>。</li><li>build 模式（去掉 --watch 参数） 将不会监听文件修改，并会对代码进行压缩打包。</li><li>dev 模式生成的文件较大，设置环境变量 NODE_ENV 为 production 可以开启压缩，方便预览，但编译速度会下降。</li></ul><p>使用 build 命令都可以把 Taro 代码编译成不同端的代码（输出到 dist 目录中），然后在对应的开发工具中查看效果。</p><p>我们可以执行</p><div class="language-bash"><pre><code><span class="token function">yarn</span> dev:h5\n<span class="token comment"># 以上命令等同于</span>\ntaro build --type h5 --watch\n</code></pre></div><p>浏览器会直接打开一个网页，显示<code>Hello World</code>，默认端口为<code>10086</code>。</p><p><strong>如何生成小程序代码并预览呢？</strong></p><p>以微信小程序为例，执行：</p><div class="language-bash"><pre><code><span class="token function">yarn</span> dev:weapp\n</code></pre></div><p>输入完命令后，Taro 会将项目代码编译为微信小程序代码并输出到<code>dist</code>目录中。</p><p>此时需要我们下载<a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" target="_blank" rel="noopener noreferrer">微信开发者工具</a>，开发微信小程序必要的工具，在 h5 页面开发，在微信开发者工具上测试，最后真机调试。</p><p>接着将生成的小程序代码即<code>dist</code>目录<strong>导入到微信开发者工具</strong></p><p><img src="/blog/_assets/weapp-import.e512d6a4.png" alt="weapp-import"></p><p>上面的<code>AppID</code>需要先注册一个微信开发者账号：<a href="https://mp.weixin.qq.com/wxopen/waregister?action=step1" target="_blank" rel="noopener noreferrer">注册地址</a></p><p>导入完成后，在微信开发者应用中看到以下页面：</p><p><img src="/blog/_assets/weapp-dist-show.a9f73b9b.png" alt="weapp-dist-show"></p><p>接下来，我们可以开发一个复杂一点的应用，进一步入门 Taro。</p><h2 id="todomvc：万变不离其宗"><a class="header-anchor" href="#todomvc：万变不离其宗" aria-hidden="true">#</a> TodoMVC：万变不离其宗</h2><p>记得我最开始学 vue 的时候，我的老师给我布置了一个任务：实现 TodoMVC</p><ol><li>使用原生 js 实现</li><li>使用模板语法实现</li><li>使用 vue 实现</li><li>使用 vue+vue-router</li><li>使用 vue+vue-router+vuex 实现</li></ol><p>这样一套组合拳下来，对 vue 基本就算入门了，那么如法炮制，也可以用这种思路去入门 Taro。</p><p>Taro 中自带了 classnames，所以可以直接使用</p><p>没有产品，没有 UI，没有后端，但我有一颗改变骑行圈的决心。</p>',65)];t.render=function(s,p,t,e,c,r){return n(),a("div",null,o)};export{p as __pageData,t as default};
