<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>
      æ‚Ÿäº†ï¼Œhtml2canvasæˆªå›¾åŸç†ï¼Œå®ƒåˆ°åº•æ˜¯æ€ä¹ˆæˆªå›¾çš„ï¼Ÿ | å­¦ä¹ ç¬”è®°
    </title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/blog/_assets/style.85766dd9.css">
    <link rel="modulepreload" href="/blog/_assets/common-03e46d7f.js">
    <link rel="modulepreload" href="/blog/_assets/docs_work_html2canvas-bug.md.aa08cf62.lean.js">
    <link rel="modulepreload" href="/blog/_assets/app.4aa5a5ca.js">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="keywords" content="ç¿”å­Blog">
    <link rel="icon" href="/blog/favicon.ico">
    <link rel="stylesheet" href="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.css">
    <script src="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.js"></script>
    <script src="https://lib.baomitu.com/axios/0.21.1/axios.js"></script>
    
  </head>
  <body>
    <div id="app"><!--[--><div id="containerColor" class="no-sidebar theme" data-v-afcf09d4><header class="navbar" data-v-afcf09d4><!--[--><a class="title" aria-label="å­¦ä¹ ç¬”è®°, back to home" href="/blog/"><img class="logo" src="/blog/favicon.ico" alt="logo"><span>å­¦ä¹ ç¬”è®°</span></a><div class="flex-grow"></div><nav class="nav-links hide-mobile"><!--[--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--]--><div id="docsearch"></div><!----><!----></nav><!--[--><!--]--><!--]--><div class="sidebar-button" data-v-afcf09d4><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div></header><aside class="" data-v-afcf09d4><!--[--><nav class="nav-links show-mobile"><!--[--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--]--><div id="docsearch"></div><!----><!----></nav><!--[--><!--]--><ul class="sidebar"><!--[--><!--]--></ul><!--[--><!--]--><!--]--></aside><!----><!-- TODO: make this button accessible --><div class="sidebar-mask" data-v-afcf09d4></div><main data-v-afcf09d4><!--[--><div class="content"><!--[--><!--]--><div class="md-header"><div class="md-title">æ‚Ÿäº†ï¼Œhtml2canvasæˆªå›¾åŸç†ï¼Œå®ƒåˆ°åº•æ˜¯æ€ä¹ˆæˆªå›¾çš„ï¼Ÿ</div><span id="jinrishici-sentence">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯....</span><div class="md-date">2023-08-21</div></div><ul class="catalog"><!--[--><li class="catalog-item"><a class="level level-2" href="#ğŸ›-é—®é¢˜å¤ç°">ğŸ› é—®é¢˜å¤ç°</a><!----></li><li class="catalog-item"><a class="level level-2" href="#è°ƒè¯•å¼€å§‹">è°ƒè¯•å¼€å§‹</a><!----></li><li class="catalog-item"><!----><a class="level level-3" href="#renderelement-æ‰§è¡Œæµç¨‹">renderElement æ‰§è¡Œæµç¨‹</a></li><li class="catalog-item"><!----><a class="level level-3" href="#å…‹éš†åŸå§‹-dom">å…‹éš†åŸå§‹ DOM</a></li><li class="catalog-item"><!----><a class="level level-3" href="#ç»˜åˆ¶-canvas">ç»˜åˆ¶ canvas</a></li><li class="catalog-item"><a class="level level-2" href="#é’ˆå¯¹æ­¤-bug-åˆ†æ">é’ˆå¯¹æ­¤ Bug åˆ†æ</a><!----></li><li class="catalog-item"><a class="level level-2" href="#è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</a><!----></li><li class="catalog-item"><!----><a class="level level-3" href="#foreignobjectrendering">foreignObjectRendering</a></li><li class="catalog-item"><!----><a class="level level-3" href="#å¯¹åŒ…å«èƒŒæ™¯è‰²çš„å†…è”æ ‡ç­¾æˆªæ–­å¤„ç†">å¯¹åŒ…å«èƒŒæ™¯è‰²çš„å†…è”æ ‡ç­¾æˆªæ–­å¤„ç†</a></li><li class="catalog-item"><a class="level level-2" href="#æ€»ç»“">æ€»ç»“</a><!----></li><!--]--></ul><div><h2 id="ğŸ›-é—®é¢˜å¤ç°"><a class="header-anchor" href="#ğŸ›-é—®é¢˜å¤ç°" aria-hidden="true">#</a> ğŸ› é—®é¢˜å¤ç°</h2><p>ä¹‹å‰åœ¨åš html å†…å®¹å¯¼å‡ºä¸º pdfã€å›¾ç‰‡æ—¶ï¼Œæˆ‘ç”¨çš„æ˜¯ html2canvas ç”Ÿæˆæˆªå±ï¼Œå†è¿›ä¸€æ­¥è½¬æ¢ä¸º pdf æ–‡ä»¶ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥çœ‹ä¸‹è¿™ç¯‡<a href="https://juejin.cn/post/7220434734966571068" target="_blank" rel="noopener noreferrer">ä¸€æ–‡æå®šå‰ç«¯ html å†…å®¹è½¬å›¾ç‰‡ã€pdf å’Œ word ç­‰æ–‡ä»¶</a>ï¼Œæˆªå›¾å¾—åˆ°çš„å›¾ç‰‡å†…å®¹ã€è´¨é‡éƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚</p><p>ä¸è¿‡æœ€è¿‘æœ‰ä¸ªåŒäº‹ååº”ï¼Œä»–å¯¼å‡ºçš„å›¾ç‰‡æœ‰ bugï¼Œè¿™æˆ‘å€’æŒºå¥½å¥‡çš„ï¼Œå› ä¸ºè¿™ä¸ªå¯¼å‡ºåŠŸèƒ½å·²ç»ç”¨äº†å¾ˆä¹…ï¼Œå¹¶æ²¡æœ‰äººåé¦ˆè¿‡æœ‰é—®é¢˜ï¼ˆé™¤äº†é‚£ä¸ª <strong>pdf ç¿»é¡µå†…å®¹è¢«æˆªæ–­</strong>çš„é—®é¢˜ï¼Œæ±‚åŠ© jym ğŸ™ï¼šå‰ç«¯æœ‰å¥½çš„è§£å†³æ–¹æ³•å—ï¼Ÿï¼‰ï¼Œäºæ˜¯æˆ‘è¦äº†ä»–çš„æ–‡æ¡£ï¼Œæœä¸å…¶ç„¶ï¼Œå‡ºç°äº†ä¸‹é¢çº¢æ¡†æ‰€ç¤ºçš„é—®é¢˜ã€‚</p><p><img src="/blog/_assets/html2canvas-export-png.41f26764.png" alt="html2canvas-export-png"></p><p>æ£€æŸ¥ä¸€ä¸‹å®ƒçš„ DOM ç»“æ„ï¼Œå‘ç°æ˜¯ä¸‹é¢è¿™æ ·ï¼ŒçŒœæµ‹æ˜¯å°±æ˜¯è¿™ä¸ªåŸå› å¯¼è‡´çš„ã€‚</p><p><img src="/blog/_assets/html2canvas-mark-bug.d8b06493.png" alt="html2canvas-mark-bug"></p><p>ä¸ºäº†éªŒè¯è‡ªå·±çš„çŒœæƒ³ï¼Œæµ…æµ…è°ƒè¯•ä¸€ä¸‹ html2canvas çš„æºç ï¼Œçœ‹ä¸‹ html2canvas æ˜¯æ€æ ·ä¸€ä¸ªæµç¨‹ï¼Œå®ƒæ˜¯å¦‚ä½•å°† html å†…è½¬æˆ canvas çš„ã€‚</p><h2 id="è°ƒè¯•å¼€å§‹"><a class="header-anchor" href="#è°ƒè¯•å¼€å§‹" aria-hidden="true">#</a> è°ƒè¯•å¼€å§‹</h2><p>æˆ‘ä»¬åœ¨ html2canvas æ‰§è¡Œçš„åœ°æ–¹æ‰“ä¸ªæ–­ç‚¹ï¼Œå¼€å§‹è°ƒè¯•ä»£ç ï¼š</p><p><img src="/blog/_assets/html2canvas-point.528501d7.png" alt="html2canvas-point.png"></p><p>è¿›å…¥ html2canvas å†…éƒ¨ï¼Œå¯ä»¥çœ‹åˆ°å†…éƒ¨æ‰§è¡Œçš„æ˜¯ renderElement æ–¹æ³•ï¼š</p><p><img src="/blog/_assets/html2canvas-renderElement.4b67604a.png" alt="html2canvas-renderElement"></p><p>æˆ‘ä»¬ç›´æ¥è¿›å…¥åˆ° renderElement æ–¹æ³•å†…éƒ¨ï¼Œçœ‹ä¸‹å®ƒçš„æ‰§è¡Œæµç¨‹ï¼š</p><h3 id="renderelement-æ‰§è¡Œæµç¨‹"><a class="header-anchor" href="#renderelement-æ‰§è¡Œæµç¨‹" aria-hidden="true">#</a> renderElement æ‰§è¡Œæµç¨‹</h3><h4 id="åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦æœ‰æ•ˆ"><a class="header-anchor" href="#åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦æœ‰æ•ˆ" aria-hidden="true">#</a> åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦æœ‰æ•ˆ</h4><p><img src="/blog/_assets/html2canvas-validate-element.7f6460d9.png" alt="html2canvas-validate-element"></p><ul><li><code>Node.ownerDocument</code>ï¼šåªè¯»å±æ€§ï¼Œè¿”å›å½“å‰èŠ‚ç‚¹çš„é¡¶å±‚çš„ document å¯¹è±¡ï¼›</li><li><code>document.defaultView</code>ï¼šå±æ€§è¿”å›å½“å‰ document å¯¹è±¡æ‰€å…³è”çš„ window å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä¼šè¿”å› nullã€‚</li></ul><p>è¿™é‡Œä¸»è¦åˆ¤æ–­èŠ‚ç‚¹ï¼Œå¿«é€Ÿè·³è¿‡ï¼Œç»§ç»­æ‰§è¡Œ ğŸ‘‡ã€‚</p><h4 id="åˆå¹¶é…ç½®é¡¹"><a class="header-anchor" href="#åˆå¹¶é…ç½®é¡¹" aria-hidden="true">#</a> åˆå¹¶é…ç½®é¡¹</h4><p>å°†ç”¨æˆ·ä¼ å…¥çš„ options ä¸é»˜è®¤çš„ options åˆå¹¶</p><p><img src="/blog/_assets/html2canvas-merge-options.d2d7fa96.png" alt="html2canvas-merge-options"></p><p>æ„å»ºé…ç½®é¡¹ï¼Œå°†ä¼ å…¥çš„ <code>opts</code> ä¸é»˜è®¤é…ç½®åˆå¹¶ï¼ŒåŒæ—¶åˆå§‹åŒ–ä¸€ä¸ª <code>context</code> ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆç¼“å­˜ã€æ—¥å¿—ç­‰ï¼‰ï¼š</p><p><img src="/blog/_assets/html2canvas-context.97b02f26.png" alt="html2canvas-context.png"></p><h5 id="ç¼“å­˜å¯¹è±¡-cache"><a class="header-anchor" href="#ç¼“å­˜å¯¹è±¡-cache" aria-hidden="true">#</a> ç¼“å­˜å¯¹è±¡ cache</h5><p>å…¶ä¸­ <code>cache</code> ä¸ºç¼“å­˜å¯¹è±¡ï¼Œä¸»è¦æ˜¯<strong>é¿å…èµ„æºé‡å¤åŠ è½½</strong>çš„é—®é¢˜ã€‚</p><p>åŸç†å¦‚ä¸‹ï¼š</p><p>å¦‚æœé‡åˆ°å›¾ç‰‡é“¾æ¥ä¸º <code>blob</code>ï¼Œåœ¨åŠ è½½å®Œæˆåï¼Œä¼šæ·»åŠ åˆ°ç¼“å­˜ <code>_cache</code> ä¸­ï¼š</p><p><img src="/blog/_assets/html2canvas-cache.048dd8b6.png" alt="html2canvas-cache"></p><p>ä¸‹æ¬¡ä½¿ç”¨ç›´æ¥é€šè¿‡ <code>this._cache[src]</code> ä»ç¼“å­˜ä¸­è·å–ï¼Œä¸ç”¨å†å‘é€è¯·æ±‚ï¼š</p><p>åŒæ—¶ï¼Œ<code>cache</code> ä¸­<strong>æ§åˆ¶å›¾ç‰‡çš„åŠ è½½å’Œå¤„ç†</strong>ï¼ŒåŒ…æ‹¬ä½¿ç”¨ <code>proxy</code> ä»£ç†å’Œä½¿ç”¨ <code>cors</code> è·¨åŸŸèµ„æºå…±äº«è¿™ä¸¤ç§æƒ…å†µèµ„æºçš„å¤„ç†ã€‚</p><p>ç»§ç»­å¾€ä¸‹æ‰§è¡Œ ğŸ‘‡</p><h3 id="å…‹éš†åŸå§‹-dom"><a class="header-anchor" href="#å…‹éš†åŸå§‹-dom" aria-hidden="true">#</a> å…‹éš†åŸå§‹ DOM</h3><p>ä½¿ç”¨ DocumentCloner æ–¹æ³•å…‹éš†åŸå§‹ DOMï¼Œé¿å…ä¿®æ”¹åŸå§‹ DOMã€‚</p><p><img src="/blog/_assets/html2canvas-generate-iframe.15918af3.png" alt="html2canvas-generate-iframe"></p><p>ä½¿ç”¨ clonedReferenceElement å°†åŸå§‹ DOM è¿›è¡Œå…‹éš†ï¼Œå¹¶è°ƒç”¨ toIFrame å°†å…‹éš†åˆ°çš„ DOM ç»˜åˆ¶åˆ° iframe ä¸­è¿›è¡Œæ¸²æŸ“ï¼Œæ­¤æ—¶åœ¨ DOM æ ‘ä¸­ä¼šå‡ºç° class ä¸º html2canvas-toIFrame çš„ iframe èŠ‚ç‚¹ï¼Œé€šè¿‡ <code>window.getComputedStyle</code> å°±å¯ä»¥æ‹¿åˆ°è¦å…‹éš†çš„ç›®æ ‡èŠ‚ç‚¹ä¸Šæ‰€æœ‰çš„æ ·å¼äº†ã€‚</p><p><img src="/blog/_assets/html2canvas-toIFrame.5f5cfbdf.png" alt="html2canvas-toIFrame"></p><h3 id="ç»˜åˆ¶-canvas"><a class="header-anchor" href="#ç»˜åˆ¶-canvas" aria-hidden="true">#</a> ç»˜åˆ¶ canvas</h3><p>å‰é¢å‡ æ­¥å¾ˆç®€å•ï¼Œä¸»è¦æ˜¯å¯¹ä¼ å…¥çš„ DOM å…ƒç´ è¿›è¡Œè§£æï¼Œè·å–ç›®æ ‡èŠ‚ç‚¹çš„æ ·å¼å’Œå†…å®¹ã€‚é‡ç‚¹æ˜¯ <code>toCanvas</code> å³å°† DOM æ¸²æŸ“ä¸º canvas è¿™ä¸ªè¿‡ç¨‹ï¼Œhtml2canvas æä¾›äº†ä¸¤ç§ç»˜åˆ¶ canvas çš„æ–¹å¼ï¼š</p><ol><li>ä½¿ç”¨ foreignObject æ–¹å¼ç»˜åˆ¶ canvas</li><li>ä½¿ç”¨çº¯ canvas æ–¹æ³•ç»˜åˆ¶</li></ol><p>å’±ä»¬æ¥ç€æ‰§è¡Œï¼Œå½“ä»£ç æ‰§è¡Œåˆ°è¿™é‡Œæ—¶åˆ¤æ–­æ˜¯å¦ä½¿ç”¨ foreignObject çš„æ–¹å¼ç”Ÿæˆ canvasï¼š</p><p><img src="/blog/_assets/html2canvas-foreignObjectRendering.dc5a4897.png" alt="html2canvas-foreignObjectRendering"></p><h4 id="ä½¿ç”¨-foreignobject-æ–¹å¼ç»˜åˆ¶-canvas"><a class="header-anchor" href="#ä½¿ç”¨-foreignobject-æ–¹å¼ç»˜åˆ¶-canvas" aria-hidden="true">#</a> ä½¿ç”¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/foreignObject" target="_blank" rel="noopener noreferrer">foreignObject</a> æ–¹å¼ç»˜åˆ¶ canvas</h4><p>é¦–å…ˆäº†è§£ä¸‹ foreignObject æ˜¯ä»€ä¹ˆï¼Ÿ</p><ol><li><p>svg ä¸­çš„<code>xmlns</code> å…¨ç§°æ˜¯â€œXML Namespacesâ€ï¼Œå³ XML å‘½åç©ºé—´ï¼Œæ­£æ˜¯å®ƒçš„å­˜åœ¨ï¼Œåœ¨æµè§ˆå™¨ä¸­ svg æ‰èƒ½æ­£å¸¸æ¸²æŸ“ï¼ˆä¸‹é¢è¿™æ®µä»£ç æ˜¯åœ¨ iconfont ä¸Šéšä¾¿å¤åˆ¶çš„ä¸€ä¸ª icon svg ä»£ç ï¼‰ï¼›</p><div class="language-xml"><pre><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">t</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1692613183565<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 0 1024 1024<span class="token punctuation">&quot;</span></span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.1<span class="token punctuation">&quot;</span></span> 		<span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2000/svg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">p-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20058<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>200<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>200<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>M548.571429 292.571429v182.784L731.428571 475.428571v73.142858l-182.857142-0.073143V731.428571h-73.142858V548.498286L292.571429 548.571429v-73.142858l182.857142-0.073142V292.571429h73.142858z<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#626B7D<span class="token punctuation">&quot;</span></span> <span class="token attr-name">p-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20059<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li><li><p>foreignObject å…è®¸åŒ…å«æ¥è‡ªä¸åŒçš„ XML å‘½åç©ºé—´çš„å…ƒç´ ï¼Œå€ŸåŠ© <code>&lt;foreignObject&gt;</code> æ ‡ç­¾ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°† DOM èŠ‚ç‚¹ä½œä¸º foreignObject æ’å…¥ SVG èŠ‚ç‚¹ä¸­è¿›è¡Œæ¸²æŸ“ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2000/svg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreignObject</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>120<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/1999/xhtml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>æµ‹è¯•æµ‹è¯•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreignObject</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ° <code>&lt;foreignObject&gt;</code> æ ‡ç­¾é‡Œé¢æœ‰ä¸€ä¸ªè®¾ç½®äº† <code>xmlns=&quot;http://www.w3.org/1999/xhtml&quot;</code> å‘½åç©ºé—´çš„ <code>&lt;body&gt;</code> æ ‡ç­¾ï¼Œæ­¤æ—¶ <code>&lt;body&gt;</code> æ ‡ç­¾åŠå…¶å­æ ‡ç­¾éƒ½ä¼šæŒ‰ç…§ XHTML æ ‡å‡†æ¸²æŸ“ï¼Œå®ç°äº† SVG å’Œ XHTML çš„æ··åˆä½¿ç”¨ã€‚</p><p>è¿™æ ·åªéœ€è¦æŒ‡å®šå¯¹åº”çš„å‘½åç©ºé—´ï¼Œå°±å¯ä»¥æŠŠå®ƒåµŒå¥—åˆ° foreignObject ä¸­ï¼Œç„¶åç»“åˆ SVGï¼Œç›´æ¥æ¸²æŸ“ã€‚</p><p>å¯¹äºä¸åŒçš„å‘½åç©ºé—´ï¼Œæµè§ˆå™¨è§£æçš„æ–¹å¼ä¹Ÿä¸ä¸€æ ·ï¼Œæ‰€ä»¥åœ¨ SVG ä¸­åµŒå¥— HTMLï¼Œè§£æ SVG çš„æ—¶å€™é‡åˆ° <code>http://www.w3.org/2000/svg</code> è½¬åŒ– SVG çš„è§£ææ–¹å¼ï¼Œå½“é‡åˆ°äº† <code>http://www.w3.org/1999/xhtml</code> å°±ä½¿ç”¨ HTML çš„è§£ææ–¹å¼ã€‚</p><p>è¿™æ˜¯ä¸ºä»€ä¹ˆ SVG ä¸­å¯ä»¥åµŒå¥— HTMLï¼Œå¹¶ä¸”æµè§ˆå™¨èƒ½å¤Ÿæ­£å¸¸æ¸²æŸ“ã€‚</p></li><li><p>foreignObject å·²ç»æ”¯æŒé™¤ IE å¤–çš„ä¸»æµæµè§ˆå™¨</p><p><img src="/blog/_assets/can-i-use-foreignObject.99ce1db8.png" alt="can-i-use-foreignObject.png"></p></li></ol><p>å¼„æ‡‚ foreignObject åï¼Œæˆ‘ä»¬å°è¯•å°† <code>foreignObjectRendering</code> è®¾ç½®ä¸º <code>true</code>ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•ç”Ÿæˆ canvas çš„ï¼š</p><div class="language-js"><pre><code><span class="token function">Html2canvas</span><span class="token punctuation">(</span>warp<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">useCORS</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">foreignObjectRendering</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>åœ¨æ­¤å¤„æ‰“ä¸ªæ–­ç‚¹ï¼š</p><p><img src="/blog/_assets/html2canvas-use-foreignObjectRendering.6554810e.png" alt="html2canvas-use-foreignObjectRendering"></p><p>è¿›å…¥ ForeignObjectRenderer ç±»ä¸­</p><p><img src="/blog/_assets/html2canvas-ForeignObjectRenderer.8a3e3693.png" alt="html2canvas-ForeignObjectRenderer"></p><p>é€šè¿‡ ForeignObjectRenderer å®ä¾‹åŒ–ä¸€ä¸ª renderer æ¸²æŸ“å™¨å®ä¾‹ï¼Œåœ¨ ForeignObjectRenderer æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ– <code>this.canvas</code> å¯¹è±¡åŠå…¶ä¸Šä¸‹æ–‡ <code>this.ctx</code></p><p><img src="/blog/_assets/html2canvas-ForeignObjectRenderer-render.2bd58170.png" alt="html2canvas-ForeignObjectRenderer-render"></p><p>è°ƒç”¨ render ç”Ÿæˆ canvasï¼Œè¿›å…¥åˆ° render æ–¹æ³•ï¼š</p><p><img src="/blog/_assets/html2canvas-ForeignObjectRenderer-render1.80a6f7af.png" alt="html2canvas-ForeignObjectRenderer-render1"></p><p>render æ–¹æ³•æ‰§è¡Œå¾ˆç®€å•ï¼Œé¦–å…ˆé€šè¿‡ createForeignObjectSVG å°† DOM å†…å®¹åŒ…è£…åˆ°<code>&lt;foreignObject&gt;</code>ä¸­ç”Ÿæˆ svg:</p><p><img src="/blog/_assets/html2canvas-foreignObject-createForeignObjectSVG.5d98b1f5.png" alt="html2canvas-foreignObject-createForeignObjectSVG"></p><p>ç”Ÿæˆçš„ svg å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/blog/_assets/html2canvas-foreignObject-svg.de99fe85.png" alt="html2canvas-foreignObject-svg"></p><p>æ¥ç€é€šè¿‡ã€‚loadSerializedSVG å°†ä¸Šé¢çš„ SVG åºåˆ—åŒ–æˆ img çš„ srcï¼ˆSVG ç›´æ¥å†…è”ï¼‰ï¼Œè°ƒç”¨<code>this.ctx.drawImage(img, ...);</code> å°†å›¾ç‰‡ç»˜åˆ¶åˆ° <code>this.canvas</code> ä¸Šï¼Œè¿”å›ç”Ÿæˆå¥½çš„ canvas å³å¯ã€‚</p><div class="language-js"><pre><code>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span>
</code></pre></div><p>æ¥ç€ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œç›´åˆ°å›åˆ°æœ€å¼€å§‹çš„æ–­ç‚¹å¤„ï¼Œå°†ç”Ÿæˆå¥½çš„ canvas æŒ‚åœ¨åˆ° DOM ä¸Šï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/blog/_assets/html2canvas-foreignObject-canvas.5ba9d434.png" alt="html2canvas-foreignObject-canvas.png"></p><p>è¿™å°±è§£å†³äº†ï¼Ÿï¼Ÿï¼Ÿæ”¶å·¥ ğŸ¤</p><p>NoNoNoï¼Œ<strong>ä¸ºä»€ä¹ˆä½¿ç”¨çº¯ canvas ç»˜åˆ¶å°±æœ‰é—®é¢˜å‘¢ï¼Ÿ</strong> ä½œä¸º bug ç»ˆç»“è€…ï¼Œé—®é¢˜å¿…é¡»æ‰¾å‡ºæ¥ï¼Œå¹²å°±å®Œäº† ğŸ‘Šã€‚</p><blockquote><p>ä½¿ç”¨ foreignObject æ¸²æŸ“è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œåé¢å†è¯´ã€‚</p></blockquote><h4 id="foreignobject-ç»˜åˆ¶-canvas-çš„æµç¨‹"><a class="header-anchor" href="#foreignobject-ç»˜åˆ¶-canvas-çš„æµç¨‹" aria-hidden="true">#</a> foreignObject ç»˜åˆ¶ canvas çš„æµç¨‹</h4><p><img src="/blog/_assets/html2canvas-foreignObject-flow.7c17659c.png" alt="html2canvas-foreignObject-flow"></p><ol><li>é¦–å…ˆå…‹éš†åŸå§‹ DOMï¼Œå¹¶å°†æ‰€æœ‰æ ·å¼éƒ½è½¬ä¸ºè¡Œå†…æ ·å¼ï¼Œé¿å…ä¿®æ”¹åˆ°é¡µé¢ï¼›</li><li>æ„å»º ForeignObjectRenderer æ¸²æŸ“å™¨å®ä¾‹ï¼Œè°ƒç”¨ renderer æ–¹æ³•ï¼›</li><li>å°† DOM å†…å®¹é€šè¿‡ createForeignObjectSVG è½¬ä¸º svg å…ƒç´ ï¼›</li><li>é€šè¿‡ loadSerializedSVG å°†ä¸Šé¢çš„ svg åºåˆ—åŒ–æˆ img çš„ srcï¼›</li><li>é€šè¿‡ drawImage ç»˜åˆ¶å›¾ç‰‡åˆ° canvas ä¸Šã€‚</li></ol><h4 id="ä½¿ç”¨çº¯-canvas-ç»˜åˆ¶"><a class="header-anchor" href="#ä½¿ç”¨çº¯-canvas-ç»˜åˆ¶" aria-hidden="true">#</a> ä½¿ç”¨çº¯ canvas ç»˜åˆ¶</h4><p>è¦æƒ³ä½¿ç”¨ canvas ç»˜åˆ¶ï¼Œé‚£ä¹ˆå°±éœ€è¦å°† DOM æ ‘è½¬æ¢ä¸º canvas å¯ä»¥ä½¿ç”¨çš„æ•°æ®ç±»å‹ï¼Œhtml2canvas ä½¿ç”¨ parseTree æ–¹æ³•æ¥å®ç°è½¬æ¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å®ƒçš„æ‰§è¡Œè¿‡ç¨‹ã€‚</p><p>ç›´æ¥åœ¨è°ƒç”¨ parseTree æ–¹æ³•å¤„æ‰“æ–­ç‚¹ï¼Œè¿›å…¥åˆ° parseTree æ–¹æ³•å†…ï¼š</p><p><img src="/blog/_assets/html2canvas-canvas-pasteTree.d329296d.png" alt="html2canvas-canvas-pasteTree"></p><p>parseTree çš„ä½œç”¨æ˜¯å°†å…‹éš† DOM è½¬æ¢ä¸º ElementContainer æ ‘ã€‚</p><p>é¦–å…ˆå°†æ ¹èŠ‚ç‚¹è½¬æ¢ä¸º ElementContainer å¯¹è±¡ï¼Œæ¥ç€å†è°ƒç”¨ parseNodeTree éå†æ ¹èŠ‚ç‚¹ä¸‹çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè½¬æ¢ä¸º ElementContainer å¯¹è±¡ã€‚</p><p><img src="/blog/_assets/html2canvas-canvas-pasteNodeTree.6227fee5.png" alt="html2canvas-canvas-pasteNodeTree.png"></p><p>ElementContainer å¯¹è±¡ä¸»è¦åŒ…å« DOM å…ƒç´ çš„ä¿¡æ¯ï¼š</p><div class="language-ts"><pre><code><span class="token keyword">type</span> <span class="token class-name">TextContainer</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ–‡æœ¬å†…å®¹</span>
  text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">// ä½ç½®å’Œå¤§å°ä¿¡æ¯</span>
  textBounds<span class="token operator">:</span> TextBounds<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ElementContainer</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ ·å¼æ•°æ®</span>
  <span class="token keyword">readonly</span> styles<span class="token operator">:</span> CSSParsedDeclaration<span class="token punctuation">;</span>
  <span class="token comment">// å½“å‰èŠ‚ç‚¹ä¸‹çš„æ–‡æœ¬èŠ‚ç‚¹</span>
  <span class="token keyword">readonly</span> textNodes<span class="token operator">:</span> TextContainer<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">//  é™¤æ–‡æœ¬èŠ‚ç‚¹å¤–çš„å­å…ƒç´ </span>
  <span class="token keyword">readonly</span> elements<span class="token operator">:</span> ElementContainer<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// ä½ç½®å¤§å°ä¿¡æ¯ï¼ˆå®½/é«˜ã€æ¨ª/çºµåæ ‡ï¼‰</span>
  bounds<span class="token operator">:</span> Bounds<span class="token punctuation">;</span>
  <span class="token comment">// æ ‡å¿—ä½ï¼Œç”¨æ¥å†³å®šå¦‚ä½•æ¸²æŸ“çš„æ ‡å¿—</span>
  flags <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ElementContainer å¯¹è±¡æ˜¯ä¸€é¢—æ ‘çŠ¶ç»“æ„ï¼Œå±‚å±‚é€’å½’ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«ä»¥ä¸Šå­—æ®µï¼Œå½¢æˆä¸€é¢— ElementContainer æ ‘ï¼Œå¦‚ä¸‹ï¼š <img src="/blog/_assets/html2canvas-canvas-ElementContainer.6966aab7.png" alt="html2canvas-canvas-ElementContainer"></p><p>ç»§ç»­ä¸‹ä¸€æ­¥ ğŸ‘‡</p><p>é€šè¿‡ CanvasRenderer åˆ›å»ºä¸€ä¸ªæ¸²æŸ“å™¨ rendererï¼Œåˆ›å»º <code>this.canvas</code>å’Œ<code>this.ctx</code>ä¸Šä¸‹æ–‡å¯¹è±¡ä¸ ForeignObjectRenderer ç±»ä¼¼</p><p>å¾—åˆ°æ¸²æŸ“å™¨åï¼Œè°ƒç”¨ render æ–¹æ³•å°† parseTree ç”Ÿæˆçš„ ElementContainer æ ‘æ¸²æŸ“æˆ canvasï¼Œåœ¨è¿™é‡Œå°±ä¸ ForeignObjectRenderer çš„ render æ–¹æ³•äº§ç”Ÿå·®åˆ«äº†ã€‚</p><p>canvas åœ¨ç»˜åˆ¶èŠ‚ç‚¹æ—¶éœ€è¦å…ˆ<strong>è®¡ç®—å‡ºæ•´ä¸ªç›®æ ‡èŠ‚ç‚¹é‡Œå­èŠ‚ç‚¹æ¸²æŸ“æ—¶æ‰€å±•ç°çš„ä¸åŒå±‚çº§</strong>ï¼Œå› ä¸º Canvas ç»˜å›¾éœ€è¦æ ¹æ®æ ·å¼è®¡ç®—å“ªäº›å…ƒç´ åº”è¯¥ç»˜åˆ¶åœ¨ä¸Šå±‚ï¼Œå“ªäº›åœ¨ä¸‹å±‚ã€‚å…ƒç´ åœ¨æµè§ˆå™¨ä¸­æ¸²æŸ“æ—¶ï¼Œæ ¹æ® W3C çš„æ ‡å‡†ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹å±‚çº§å¸ƒå±€ï¼Œéœ€è¦<strong>éµå¾ªå±‚å ä¸Šä¸‹æ–‡å’Œå±‚å é¡ºåºçš„æ ‡å‡†</strong>ã€‚æ‰€ä»¥ä¼šå…ˆè°ƒç”¨ parseStackingContexts æ–¹æ³•å°† parseTree ç”Ÿæˆçš„ ElementContainer æ ‘è½¬ä¸ºå±‚å ä¸Šä¸‹æ–‡ã€‚</p><h5 id="ä»€ä¹ˆæ˜¯å±‚å ä¸Šä¸‹æ–‡"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯å±‚å ä¸Šä¸‹æ–‡" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯å±‚å ä¸Šä¸‹æ–‡</h5><p>æ¦‚å¿µä¸æ‡‚å°±çœ‹ MDNï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_positioned_layout/Understanding_z-index/Stacking_context" target="_blank" rel="noopener noreferrer">å±‚å ä¸Šä¸‹æ–‡</a></p><p>é¦–å…ˆæˆ‘ä»¬éƒ½çŸ¥é“ CSS æ˜¯æµå¼å¸ƒå±€ï¼Œä¹Ÿå°±æ˜¯åœ¨æ²¡æœ‰æµ®åŠ¨ï¼ˆfloatï¼‰å’Œå®šä½ï¼ˆpositionï¼‰çš„å½±å“ä¸‹ï¼Œæ˜¯ä¸ä¼šå‘ç”Ÿé‡å çš„ï¼Œä»ä¸Šåˆ°ä¸‹ã€ç”±å¤–åˆ°å†…æŒ‰ç…§ DOM æ ‘å»å¸ƒå±€ã€‚</p><p>è€Œæµ®åŠ¨å’Œå®šä½çš„å…ƒç´ ä¼šè„±ç¦»æ–‡æ¡£æµï¼Œå½¢æˆä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥å¦‚æœæƒ³æ­£å¸¸æ¸²æŸ“ï¼Œå°±éœ€è¦å¾—åˆ°å®ƒä»¬çš„å±‚å ä¿¡æ¯ã€‚</p><p>å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼šåœ¨æˆ‘ä»¬çš„è§†çº¿ä¸ç½‘é¡µä¹‹é—´æœ‰ä¸€æ¡çœ‹ä¸è§çš„ z è½´ï¼Œå±‚å ä¸Šä¸‹æ–‡å°±æ˜¯ä¸€å—å—è–„å±‚ï¼Œè€Œè¿™äº›è–„å±‚ä¸­æœ‰å¾ˆå¤š DOM å…ƒç´ ï¼Œè¿™äº›è–„å±‚æ ¹æ®å±‚å ä¿¡æ¯åœ¨è¿™ä¸ª z è½´ä¸Šæ’åˆ—ï¼Œæœ€ç»ˆå½¢æˆäº†æˆ‘ä»¬çœ‹åˆ°çš„å¤šå½©çš„é¡µé¢ã€‚</p><p>ç”»ä¸ªå›¾å¥½åƒæ›´å½¢è±¡äº›ï¼š</p><blockquote><p>ç™½è‰²ä¸ºæ­£å¸¸å…ƒç´ ï¼Œé»„è‰²ä¸º float å…ƒç´ ï¼Œè“è‰²ä¸º position å…ƒç´ </p></blockquote><p><img src="/blog/_assets/stacking-contex.f16c73ce.png" alt="stacking-context"></p><p>æ›´å¤šè¯¦ç»†èµ„æ–™è¯·é˜…è¯»ï¼š<a href="https://www.zhangxinxu.com/wordpress/2016/01/understand-css-stacking-context-order-z-index/" target="_blank" rel="noopener noreferrer">æ·±å…¥ç†è§£ CSS ä¸­çš„å±‚å ä¸Šä¸‹æ–‡å’Œå±‚å é¡ºåº</a></p><p>ElementContainer æ ‘ä¸­çš„æ¯ä¸€ä¸ª ElementContainer èŠ‚ç‚¹éƒ½ä¼šäº§ç”Ÿä¸€ä¸ª ElementPaint å¯¹è±¡ï¼Œæœ€ç»ˆç”Ÿæˆå±‚å ä¸Šä¸‹æ–‡çš„ StackingContext å¦‚ä¸‹ï¼š</p><p><img src="/blog/_assets/html2canvas-canvas-StackingContext.ba0ab836.png" alt="html2canvas-canvas-StackingContext"></p><p>æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language-ts"><pre><code><span class="token comment">// ElementPaint æ•°æ®ç»“æ„å¦‚ä¸‹</span>
ElementPaint<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// å½“å‰å…ƒç´ çš„container</span>
  container<span class="token operator">:</span> ElementContainer
  <span class="token comment">// å½“å‰å…ƒç´ çš„borderä¿¡æ¯</span>
  curves<span class="token operator">:</span> BoundCurves
<span class="token punctuation">}</span>

<span class="token comment">// StackingContext æ•°æ®ç»“æ„å¦‚ä¸‹</span>
<span class="token punctuation">{</span>
  element<span class="token operator">:</span> ElementPaint<span class="token punctuation">;</span>
  <span class="token comment">// z-indexä¸ºè´Ÿçš„å…ƒç´ è¡Œæµ‹ä¼šç»™ä½ çš„å±‚å ä¸Šä¸‹æ–‡</span>
  negativeZIndex<span class="token operator">:</span> StackingContext<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// z-indexä¸ºé›¶æˆ–autoã€transformæˆ–è€…opacityå…ƒç´ å½¢æˆçš„å±‚å ä¸Šä¸‹æ–‡</span>
  zeroOrAutoZIndexOrTransformedOrOpacity<span class="token operator">:</span> StackingContext<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// å®šä½æˆ–z-indexå¤§äºç­‰äº1çš„å…ƒç´ å½¢æˆçš„å±‚å ä¸Šä¸‹æ–‡</span>
  positiveZIndex<span class="token operator">:</span> StackingContext<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// éå®šä½çš„æµ®åŠ¨å…ƒç´ å½¢æˆçš„å±‚å ä¸Šä¸‹æ–‡</span>
  nonPositionedFloats<span class="token operator">:</span> StackingContext<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// å†…è”çš„éå®šä½å…ƒç´ å½¢æˆçš„å±‚å ä¸Šä¸‹æ–‡</span>
  nonPositionedInlineLevel<span class="token operator">:</span> StackingContext<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// å†…è”å…ƒç´ </span>
  inlineLevel<span class="token operator">:</span> ElementPaint<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// éå†…è”å…ƒç´ </span>
  nonInlineLevel<span class="token operator">:</span> ElementPaint<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ¸²æŸ“å±‚å å†…å®¹æ—¶ä¼šæ ¹æ® StackingContext æ¥å†³å®šæ¸²æŸ“çš„é¡ºåºã€‚</p><p>ç»§ç»­ä¸‹ä¸€æ­¥ï¼Œè°ƒç”¨ renderStack æ–¹æ³•ï¼ŒrenderStack æ‰§è¡Œ renderStackContent æ–¹æ³•ï¼Œæˆ‘ä»¬ç›´æ¥è¿›å…¥ renderStackContent å†…ï¼š</p><p><img src="/blog/_assets/html2canvas-canvas-renderStackContent.dca3632d.png" alt="html2canvas-canvas-renderStackContent"></p><p>canvas ç»˜åˆ¶æ—¶éµå¾ª w3c è§„å®šçš„æ¸²æŸ“è§„åˆ™ <a href="https://www.w3.org/TR/css-position-3/#painting-order" target="_blank" rel="noopener noreferrer">painting-order</a>ï¼ŒrenderStackContent æ˜¯å¯¹æ­¤è§„åˆ™çš„ä¸€ä¸ªä»£ç å®ç°ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>æ­¤å¤„çš„æ­¥éª¤ 1-7 å¯¹åº”ä¸Šå›¾ä»£ç ä¸­çš„ 1-7:</p><ol><li>æ¸²æŸ“å½“å‰å±‚å ä¸Šä¸‹æ–‡çš„å…ƒç´ çš„èƒŒæ™¯å’Œè¾¹æ¡†ï¼›</li><li>æ¸²æŸ“å…·æœ‰è´Ÿ z-index çº§åˆ«çš„å­å±‚å ä¸Šä¸‹æ–‡ï¼ˆæœ€è´Ÿçš„ç¬¬ä¸€ä¸ªï¼‰ï¼›</li><li>å¯¹äºæµå¼å¸ƒå±€ã€éå®šä½çš„å­å…ƒç´ è°ƒç”¨ renderNodeContent å’Œ renderNode è¿›è¡Œæ¸²æŸ“ï¼š</li><li>æ¸²æŸ“æ‰€æœ‰æœªå®šä½çš„æµ®åŠ¨å­å…ƒç´ ï¼Œå¯¹äºå…¶ä¸­æ¯ä¸€ä¸ªï¼Œå°†è¯¥å…ƒç´ è§†ä¸ºåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å †æ ˆä¸Šä¸‹æ–‡ï¼›</li><li>æ¸²æŸ“æ­£å¸¸æµå¼å¸ƒå±€ã€å†…è”å…ƒç´ ã€éå®šä½çš„å­å…ƒç´ ï¼›</li><li>æ¸²æŸ“ z-index ä¸º 0 æˆ– autoï¼Œæˆ–è€… transformã€opacity ç­‰å±æ€§çš„å­å…ƒç´ ï¼›</li><li>æ¸²æŸ“ç”± z-index å¤§äºæˆ–ç­‰äº 1 çš„å­å…ƒç´ å½¢æˆçš„å±‚å ä¸Šä¸‹æ–‡ï¼ŒæŒ‰ z-index é¡ºåºï¼ˆæœ€å°çš„åœ¨å‰ï¼‰ã€‚</li></ol><p>å¯ä»¥çœ‹åˆ°éå†æ—¶ä¼šå¯¹å½¢æˆå±‚å ä¸Šä¸‹æ–‡çš„å­å…ƒç´ é€’å½’è°ƒç”¨ renderStackï¼Œæœ€ç»ˆè¾¾åˆ°å¯¹æ•´ä¸ªå±‚å ä¸Šä¸‹æ–‡æ ‘è¿›è¡Œé€’å½’çš„ç›®çš„ï¼š</p><p>è€Œå¯¹äºæœªå½¢æˆå±‚å ä¸Šä¸‹æ–‡çš„å­å…ƒç´ ï¼Œå°±ç›´æ¥è°ƒç”¨ renderNode æˆ– renderNodeContent è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸¤è€…å¯¹æ¯”ï¼Œ<strong>renderNode å¤šäº†ä¸€å±‚æ¸²æŸ“èŠ‚ç‚¹çš„è¾¹æ¡†å’ŒèƒŒæ™¯è‰²çš„æ–¹æ³•</strong>ï¼ˆrenderNode å‡½æ•°å†…éƒ¨è°ƒç”¨ renderNodeBackgroundAndBorders å’Œ renderNodeContent æ–¹æ³•ï¼‰ã€‚</p><p>renderNodeContent ç”¨äºæ¸²æŸ“ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹é‡Œé¢çš„å†…å®¹ï¼Œåˆ†ä¸ºå…«ç§ç±»å‹ï¼šçº¯æ–‡æœ¬ã€å›¾ç‰‡ã€canvasã€svgã€iframeã€checkbox å’Œ radioã€inputã€li å’Œ olã€‚</p><p>é™¤äº† iframe çš„ç»˜åˆ¶æ¯”è¾ƒç‰¹æ®Šï¼šé‡æ–°ç”Ÿæˆæ¸²æŸ“å™¨å®ä¾‹ï¼Œè°ƒç”¨ render æ–¹æ³•é‡æ–°ç»˜åˆ¶ï¼Œå…¶ä»–çš„ç»˜åˆ¶éƒ½æ˜¯è°ƒç”¨ canvas çš„ä¸€äº› API æ¥å®ç°ï¼Œæ¯”å¦‚ç»˜åˆ¶æ–‡å­—ä¸»è¦ç”¨ fillText æ–¹æ³•ã€ç»˜åˆ¶å›¾ç‰‡ã€canvasã€svg éƒ½æ˜¯è°ƒç”¨ drawImage æ–¹æ³•è¿›è¡Œç»˜åˆ¶ã€‚</p><p><img src="/blog/_assets/html2canvas-canvas-renderNode.b939265f.png" alt="html2canvas-canvas-renderNode"></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D" target="_blank" rel="noopener noreferrer">æ‰€æœ‰å¯èƒ½ç”¨åˆ°çš„ API</a></p><p>æœ€ç»ˆç»˜åˆ¶åˆ° <code>this.canvas</code> ä¸Šè¿”å›ï¼Œè‡³æ­¤ï¼Œhtml2canvas çš„è°ƒè¯•å°±ç»“æŸäº†ã€‚ ğŸ‰ğŸ‰ğŸ‰</p><h4 id="çº¯-canvas-ç»˜åˆ¶æµç¨‹"><a class="header-anchor" href="#çº¯-canvas-ç»˜åˆ¶æµç¨‹" aria-hidden="true">#</a> çº¯ canvas ç»˜åˆ¶æµç¨‹</h4><p><img src="/blog/_assets/html2canvas-canvas-flow.97631e48.png" alt="html2canvas-canvas-flow"></p><ol><li>é¦–å…ˆå…‹éš†åŸå§‹ DOMï¼Œé¿å…ä¿®æ”¹åˆ°é¡µé¢</li><li>ä½¿ç”¨ parseTree é€’å½’éå† htmlï¼Œç”Ÿæˆ ElementContainer æ ‘ï¼ˆä¸åŸå§‹ DOM å±‚çº§ç»“æ„ç±»ä¼¼ï¼‰</li><li>æ„å»º CanvasRenderer æ¸²æŸ“å™¨å®ä¾‹ï¼Œè°ƒç”¨ renderer æ–¹æ³•</li><li>éå†ä¸Šä¸€æ­¥ç”Ÿæˆçš„ ElementContainerï¼Œæ ¹æ®å±‚å è§„åˆ™ç”Ÿæˆå±‚å ä¸Šä¸‹æ–‡ StackingContextï¼ˆä¸åŸå§‹ DOM å±‚çº§ç»“æ„åŒºåˆ«è¾ƒå¤§ï¼‰</li><li>éå†å±‚å ä¸Šä¸‹æ–‡ï¼Œé€’å½’åœ°å¯¹å±‚å ä¸Šä¸‹æ–‡å„å±‚ä¸­çš„èŠ‚ç‚¹å’Œå­å±‚å ä¸Šä¸‹æ–‡è¿›è¡Œè§£æå¹¶æŒ‰é¡ºåºç»˜åˆ¶åœ¨ Canvas ä¸Šï¼Œé’ˆå¯¹è¦ç»˜åˆ¶çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªè¿‡ç¨‹ï¼š</li><li>åˆ›å»ºç”»å¸ƒï¼Œæ ¹æ®ä¸Šä¸€æ­¥ç”Ÿæˆçš„å±‚å å¯¹è±¡é€’å½’æ¸²æŸ“ï¼Œæœ€ç»ˆç»˜åˆ¶åˆ°ç”»å¸ƒ canvas ä¸Š</li></ol><h2 id="é’ˆå¯¹æ­¤-bug-åˆ†æ"><a class="header-anchor" href="#é’ˆå¯¹æ­¤-bug-åˆ†æ" aria-hidden="true">#</a> é’ˆå¯¹æ­¤ Bug åˆ†æ</h2><p>okï¼Œå½“è°ƒè¯•äº†ä¸€é html2canvas çš„æµç¨‹ä¹‹åï¼Œå†å›åˆ°æˆ‘ä»¬çš„é—®é¢˜ä¸Šï¼Œå¾ˆæ˜¾ç„¶å°±æ˜¯ canvas æ¸²æŸ“çš„æ—¶å€™çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ renderNodeContent æ–¹æ³•ï¼Œé‚£æˆ‘ä»¬ç›´æ¥åœ¨è¿™é‡Œæ‰“ä¸ªæ–­ç‚¹è¿›è¡Œè°ƒè¯•ï¼ˆä¸ºäº†æ–¹ä¾¿æˆ‘åªè¾“å…¥ä¸€è¡Œæ–‡å­—è¿›è¡Œè°ƒè¯•ï¼‰ï¼Œåªæœ‰å½“æ˜¯æ–‡æœ¬èŠ‚ç‚¹æ—¶ä¼šè¿›å…¥åˆ°æ­¤æ–­ç‚¹ï¼Œç­‰åˆ° mark æ ‡ç­¾ä¸­å¯¹åº”çš„å…ƒç´ è¿›å…¥æ–­ç‚¹æ—¶ï¼ŒæŸ¥çœ‹ï¼š</p><p><img src="/blog/_assets/html2canvas-renderNodeContent.b6427ac2.png" alt="html2canvas-renderNodeContent.png"></p><p>å¯ä»¥çœ‹åˆ°æ­¤æ—¶ width å’Œ height å·²ç»æ˜¯çˆ¶èŠ‚ç‚¹çš„å®½é«˜ï¼ŒæœçœŸå¦‚æ­¤ ğŸ˜±ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ" aria-hidden="true">#</a> è§£å†³æ–¹æ¡ˆ</h2><p>æ—¢ç„¶å·²ç»çŸ¥é“äº†é—®é¢˜æ‰€åœ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¼€å§‹è§£å†³é—®é¢˜ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§è§£å†³æ–¹æ¡ˆå¯ä¾›å‚è€ƒï¼š</p><h3 id="foreignobjectrendering"><a class="header-anchor" href="#foreignobjectrendering" aria-hidden="true">#</a> foreignObjectRendering</h3><p>åœ¨ html2canvas é…ç½®ä¸­è®¾ç½® <code>foreignObjectRendering</code> ä¸º <code>true</code>ï¼Œæ­¤é—®é¢˜å°±å¯ä»¥è§£å†³å—ï¼Ÿ</p><p>ç„¶è€Œç°å®å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œè¿™æ ·åˆä¼šå‡ºç°å¼•å‡ºæ–°çš„é—®é¢˜ï¼šå¯¼å‡ºçš„å›¾ç‰‡å†…å®¹ä¼šä¸¢å¤±</p><p>è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>é€šè¿‡ W3C å¯¹<a href="https://svgwg.org/specs/integration/#static-image-document-mode" target="_blank" rel="noopener noreferrer">SVG çš„ä»‹ç»</a>å¯çŸ¥ï¼š<strong>SVG ä¸å…è®¸è¿æ¥å¤–éƒ¨çš„èµ„æº</strong>ï¼Œæ¯”å¦‚ HTML ä¸­å›¾ç‰‡é“¾æ¥ã€CSS link æ–¹å¼çš„èµ„æºé“¾æ¥ç­‰ï¼Œåœ¨ SVG ä¸­éƒ½ä¼šæœ‰é™åˆ¶ã€‚</p><p>è§£å†³æ–¹æ³•ï¼šéœ€è¦å°†å›¾ç‰‡èµ„æºè½¬ä¸º base64ï¼Œç„¶åå†å»ç”Ÿæˆæˆªå›¾ï¼ŒforeighnObject è¿™ç§æ–¹æ³•æ›´é€‚åˆæˆªå–å†…å®¹ä¸ºæ–‡å­—å†…å®¹å±…å¤šçš„åœºæ™¯ã€‚</p><h3 id="å¯¹åŒ…å«èƒŒæ™¯è‰²çš„å†…è”æ ‡ç­¾æˆªæ–­å¤„ç†"><a class="header-anchor" href="#å¯¹åŒ…å«èƒŒæ™¯è‰²çš„å†…è”æ ‡ç­¾æˆªæ–­å¤„ç†" aria-hidden="true">#</a> å¯¹åŒ…å«èƒŒæ™¯è‰²çš„å†…è”æ ‡ç­¾æˆªæ–­å¤„ç†</h3><p>åœ¨å¯¹å†…è”å…ƒç´ è¿›è¡Œæˆªæ–­å‰ï¼Œ<strong>å¦‚ä½•ç¡®å®š p æ ‡ç­¾ä¸­çš„ mark æ ‡ç­¾æœ‰æ²¡æœ‰æ¢è¡Œï¼Ÿ</strong> å› ä¸ºæˆ‘ä»¬æ²¡å¿…è¦å¯¹æ‰€æœ‰å†…è”æ ‡ç­¾åšå¤„ç†ã€‚</p><p>å¦‚æœ mark æ ‡ç­¾çš„é«˜åº¦è¶…è¿‡ p æ ‡ç­¾çš„ä¸€åŠæ—¶ï¼Œå°±è¯´æ˜å·²ç»æ¢è¡Œäº†ï¼Œç„¶åå°† <code>&lt;mark&gt;è¦æ±‚ä¸€&lt;/mark&gt;</code> æ›¿æ¢ä¸º <code>&lt;mark&gt;è¦&lt;/mark&gt;&lt;mark&gt;æ±‚&lt;/mark&gt;&lt;mark&gt;ä¸€&lt;/mark&gt;</code> å³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-ts"><pre><code><span class="token keyword">const</span> <span class="token function-variable function">handleMarkTag</span> <span class="token operator">=</span> <span class="token punctuation">(</span>ele<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> markElements <span class="token operator">=</span> ele<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&#39;mark&#39;</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> sel <span class="token keyword">of</span> markElements<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> height <span class="token punctuation">}</span> <span class="token operator">=</span> sel<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> parentElement <span class="token operator">=</span> sel<span class="token punctuation">.</span>parentElement
    <span class="token keyword">while</span> <span class="token punctuation">(</span>parentElement<span class="token operator">?.</span>tagName <span class="token operator">!==</span> <span class="token string">&#39;P&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      parentElement <span class="token operator">=</span> parentElement<span class="token operator">?.</span>parentElement<span class="token operator">!</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> height<span class="token operator">:</span> parentHeight <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
      parentElement <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> HTMLElement
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// markçš„é«˜åº¦æ²¡æœ‰è¶…è¿‡pæ ‡ç­¾çš„ä¸€åŠæ—¶ åˆ™æ²¡æœ‰æ¢è¡Œ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>height <span class="token operator">&lt;</span> parentHeight <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">continue</span>
    <span class="token comment">// è¶…è¿‡ä¸€åŠæ—¶è¯´æ˜æ¢è¡Œäº†</span>
    <span class="token keyword">const</span> innerText <span class="token operator">=</span> sel<span class="token punctuation">.</span>innerText
    <span class="token keyword">const</span> outHtml <span class="token operator">=</span> sel<span class="token punctuation">.</span>outerHTML
    <span class="token keyword">let</span> newHtml <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
    innerText<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token operator">?.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      newHtml <span class="token operator">+=</span> outHtml<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>innerText<span class="token punctuation">,</span> text<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    sel<span class="token punctuation">.</span>outerHTML <span class="token operator">=</span> newHtml
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>okï¼Œå†æ¬¡å°è¯•ä¸€ä¸‹ï¼Œå®Œç¾è§£å†³ï¼Œè¿™ä¸‹å¯ä»¥æ”¶å·¥äº†ã€‚</p><h2 id="æ€»ç»“"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h2><p>é€šè¿‡å¯¹ä¸€ä¸ª bug çš„åˆ†æï¼Œå°è¯•è°ƒè¯•äº†ä¸€é html2canvas çš„ä»£ç ï¼Œå¼„æ‡‚äº†æµè§ˆå™¨æˆªå›¾çš„åŸç†åŠ html2canvas çš„æ ¸å¿ƒæµç¨‹ï¼Œå¹¶ä»ä¸­å­¦åˆ°äº†å‡ ç‚¹æ–°çŸ¥è¯†ï¼š</p><ol><li>svg xmnls ä½œç”¨ä»¥åŠæ¸²æŸ“ HTML å†…å®¹çš„ foreignObject æ ‡ç­¾ï¼›</li><li>CSS å±‚å ä¸Šä¸‹æ–‡çš„æ¦‚å¿µï¼›ï¼›</li><li>ä½¿ç”¨ foreignObject å®ç°å¿«é€Ÿæˆªå›¾çš„æ–¹æ³•ï¼›</li><li>canvas ç»˜å›¾çš„ä¸€äº›æ–¹æ³•ã€‚ã€‚ã€‚</li></ol><p>å‘ç° canvas çœŸæ˜¯ä¸€ä¸ªæœ‰è¶£çš„ä¸œè¥¿ï¼Œä»€ä¹ˆéƒ½èƒ½ç”»ï¼Œåƒæˆ‘ç°åœ¨ç”¨äºç”»å›¾çš„å·¥å…·<a href="https://excalidraw.com/" target="_blank" rel="noopener noreferrer">excalidraw</a>ã€å›¾è¡¨åº“<a href="https://g6.antv.antgroup.com/" target="_blank" rel="noopener noreferrer">g6</a>ã€<a href="https://g2.antv.antgroup.com/" target="_blank" rel="noopener noreferrer">g2</a>ã€<a href="https://echarts.apache.org/zh/index.html" target="_blank" rel="noopener noreferrer">echarts</a>éƒ½æ˜¯ç”¨çš„ canvas æçš„ï¼Œçœ‹æ¥å¾—æŠ½æ—¶é—´å­¦ä¹ ä¸€ä¸‹ canvasï¼Œä¸è¦ç­‰åˆ°â€œä¹¦åˆ°ç”¨æ—¶æ–¹æ¨å°‘â€œã€‚</p></div><div class="links-wrapper"><div class="prev-link"><!----></div><div class="next-link"><!----></div></div><div><footer class="page-edit"><!-- <a v-for="(item,index) in data.platform" :key="index" :href="item.href">
        <img class="imgIcon" :src="item.icon" />
      </a> --></footer><!-- <p class="platform">
      ä»¥ä¸Šçš†ä¸º
      <a href="javascript:;">çºªå¹´</a> æ–‡ç« å‘å¸ƒå¹³å°
    </p> --><p class="platform"><a href="https://beian.miit.gov.cn/" target="_blank">äº¬ICPå¤‡2022027737å·</a><br> Copyright Â© 2022 - present <a href="https://github.com/wang1xiang">@wangxiang</a></p></div><!--[--><!--]--></div><!-- åªæƒ³ç‚¹å‡»èƒŒæ™¯æ‰å…³é—­ è¯·ä½¿ç”¨ .self ä¿®é¥°ç¬¦ --><div style="display:none;" class="imgBox"><img src=""></div><!--]--></main><div class="theme-select" data-v-afcf09d4><ul data-v-afcf09d4><li class="active" data-v-afcf09d4>â˜€ï¸</li><li class="" data-v-afcf09d4>ğŸŒ‘</li></ul></div></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"README.md\":\"07af0636\",\"index.md\":\"b923b44e\",\"more_docs.md\":\"15b2b994\",\"more_index.md\":\"dc650ab7\",\"more_tags.md\":\"76473701\",\"docs_css_grid.md\":\"9595feb0\",\"docs_css_placeholder.md\":\"55053b12\",\"docs_css_tailWindcss-start.md\":\"5af3c9a3\",\"docs_docker_docker-start.md\":\"2dd8a666\",\"docs_electron_electron-bug.md\":\"df4f2a87\",\"docs_electron_electron-check-update.md\":\"559b90ba\",\"docs_electron_electron-diaoyan.md\":\"c4394a9e\",\"docs_electron_electron-object-destroyed.md\":\"9ce9893c\",\"docs_electron_electron-og.md\":\"716dce29\",\"docs_electron_electron-open-other.md\":\"0aca6a3a\",\"docs_electron_electron-protocol.md\":\"713c3865\",\"docs_electron_electron-sentry.md\":\"73b50971\",\"docs_electron_electron-sign-windows.md\":\"0a6ca603\",\"docs_electron_electron-sign.md\":\"eb1cf1a9\",\"docs_electron_electron-sqlite3-bug.md\":\"b9107a48\",\"docs_electron_electron-sqlite3-start.md\":\"804d0767\",\"docs_electron_electron-sqlite3.md\":\"67d11742\",\"docs_electron_electron-start.md\":\"2fa06da0\",\"docs_electron_electron-update.md\":\"573b6cff\",\"docs_electron_electron-webview-zoom.md\":\"592737a6\",\"docs_electron_hybrid-electron.md\":\"090cf9f7\",\"docs_electron_sentry-electron.md\":\"642cbabd\",\"docs_flutter_flutter-dart.md\":\"a8b60976\",\"docs_flutter_flutter-other.md\":\"39c73d09\",\"docs_flutter_flutter-route-manage.md\":\"d4827554\",\"docs_flutter_flutter-start.md\":\"8a68ddc3\",\"docs_flutter_flutter-state-manage.md\":\"d6cea6af\",\"docs_flutter_flutter-wechat-pay.md\":\"7998fffe\",\"docs_git_git-autocrlf.md\":\"dc657b27\",\"docs_git_git-ignorecase.md\":\"a69f6368\",\"docs_git_git-notes.md\":\"5c68e93a\",\"docs_git_git-rebase.md\":\"7de954d1\",\"docs_git_git-username.md\":\"4ed47a1a\",\"docs_git_gitflow.md\":\"054360be\",\"docs_git_gitlab-ci-start.md\":\"8bd02d6e\",\"docs_http_http.md\":\"2fd5704d\",\"docs_javascript_async-await.md\":\"33699afc\",\"docs_javascript_createEvent.md\":\"35235910\",\"docs_javascript_html2docs.md\":\"291c89b1\",\"docs_javascript_http-cache.md\":\"32c24fc8\",\"docs_javascript_image-load.md\":\"3698b01e\",\"docs_javascript_indexDB-dexie.md\":\"d78bb07d\",\"docs_javascript_javascript-utils.md\":\"9611e1c8\",\"docs_javascript_memory-leak.md\":\"74f7c44c\",\"docs_javascript_office-preview-type.md\":\"35e7d964\",\"docs_javascript_page-alive.md\":\"386f6cf0\",\"docs_javascript_performance-optimization.md\":\"c8a4cea1\",\"docs_javascript_preload-prefetch.md\":\"0bd5fcb9\",\"docs_javascript_scrollend.md\":\"a40c03d7\",\"docs_javascript_storage-change.md\":\"2b4fefe4\",\"docs_javascript_turborepo-start.md\":\"c0172bda\",\"docs_javascript_webworker.md\":\"4792ddab\",\"docs_javascript_zero-width-space.md\":\"5dd3c3cf\",\"docs_leetcode_array-code.md\":\"510d8fea\",\"docs_leetcode_array-code1.md\":\"9e411c7d\",\"docs_leetcode_back-tracking-code.md\":\"2e050812\",\"docs_leetcode_back-tracking-code1.md\":\"32ce5be6\",\"docs_leetcode_back-tracking-code2.md\":\"c0180a9e\",\"docs_leetcode_back-tracking-code3.md\":\"850d6dd7\",\"docs_leetcode_binary-tree-code.md\":\"978534ff\",\"docs_leetcode_binary-tree-code1.md\":\"7dbb2182\",\"docs_leetcode_binary-tree-code2.md\":\"d534cec4\",\"docs_leetcode_binary-tree-code3.md\":\"c79d9c38\",\"docs_leetcode_binary-tree-code4.md\":\"5f6944bb\",\"docs_leetcode_binary-tree-code5.md\":\"fe8fbafc\",\"docs_leetcode_binary-tree-code6.md\":\"c0988bda\",\"docs_leetcode_binary-tree-code7.md\":\"09c0b789\",\"docs_leetcode_dynamic-programming-code.md\":\"b5c39d05\",\"docs_leetcode_dynamic-programming-code10.md\":\"81ce6f02\",\"docs_leetcode_dynamic-programming-code11.md\":\"8d7d9ea0\",\"docs_leetcode_dynamic-programming-code12.md\":\"7016aeb8\",\"docs_leetcode_dynamic-programming-code13.md\":\"a99f4ed0\",\"docs_leetcode_dynamic-programming-code2.md\":\"0eef6035\",\"docs_leetcode_dynamic-programming-code3.md\":\"4cfa311d\",\"docs_leetcode_dynamic-programming-code4.md\":\"912b3813\",\"docs_leetcode_dynamic-programming-code5.md\":\"0ef059ca\",\"docs_leetcode_dynamic-programming-code6.md\":\"19d176ae\",\"docs_leetcode_dynamic-programming-code7.md\":\"6963d4f5\",\"docs_leetcode_dynamic-programming-code8.md\":\"a7d2668e\",\"docs_leetcode_dynamic-programming-code9.md\":\"1c0706db\",\"docs_leetcode_graph-theory2.md\":\"87721029\",\"docs_leetcode_greedy-algorithmc-code.md\":\"78f62bb2\",\"docs_leetcode_greedy-algorithmc-code2.md\":\"b9ded3b8\",\"docs_leetcode_greedy-algorithmc-code3.md\":\"4b55421b\",\"docs_leetcode_greedy-algorithmc-code4.md\":\"6049d434\",\"docs_leetcode_greedy-algorithmc-code5.md\":\"190c4e39\",\"docs_leetcode_hash-code.md\":\"b17924fa\",\"docs_leetcode_hash-code1.md\":\"4f95e8eb\",\"docs_leetcode_linked-list-code.md\":\"daefc68f\",\"docs_leetcode_linked-list-code1.md\":\"c2047c37\",\"docs_leetcode_monotone-stack.md\":\"5abb8864\",\"docs_leetcode_monotone-stack1.md\":\"9a62868e\",\"docs_leetcode_stack-code.md\":\"6d845cc4\",\"docs_leetcode_stack-code1.md\":\"74a88970\",\"docs_leetcode_string-code.md\":\"07ee4fc3\",\"docs_leetcode_string-code1.md\":\"b174d29e\",\"docs_linux_centos-docker.md\":\"434142e8\",\"docs_linux_linux-no-possword.md\":\"a249d9af\",\"docs_mobile_mobileDebugging.md\":\"ac56a58c\",\"docs_nest_mysql-satart.md\":\"bc894dda\",\"docs_nest_nest-bff.md\":\"5c939f6f\",\"docs_nest_nest-start.md\":\"2c31584f\",\"docs_node_bff-express-esm.md\":\"a85bb9ae\",\"docs_node_bff-express.md\":\"8ff9eeaa\",\"docs_node_bff.md\":\"1cd947b3\",\"docs_node_deploy-server.md\":\"b6bc1973\",\"docs_node_express-mysql2.md\":\"53bb3b62\",\"docs_node_express-swigger.md\":\"a90a89e2\",\"docs_node_socketIO-start.md\":\"8f0dd9a0\",\"docs_photography_nd.md\":\"879ced3f\",\"docs_pnpm_pnpm-monorepo.md\":\"ac513fc9\",\"docs_prosemirror_html2docs-pdf.md\":\"c2203d18\",\"docs_react_create-react-app.md\":\"3385e14c\",\"docs_react_dompurify.md\":\"5f3aa59e\",\"docs_react_eslint-react.md\":\"7e8773ef\",\"docs_react_react-classnames.md\":\"5f28142d\",\"docs_react_react-grid-layout.md\":\"91d4e779\",\"docs_react_react-intl.md\":\"3f039cc1\",\"docs_react_react-philosophies.md\":\"3beb2656\",\"docs_react_react-query.md\":\"958a33c9\",\"docs_react_react-router-change.md\":\"b05bafd2\",\"docs_react_react-vs-vue3.md\":\"76b6bfc9\",\"docs_react_redux-audition.md\":\"09ac1759\",\"docs_react_tomcat-404.md\":\"8bc6e9a8\",\"docs_reactNative_react-native-errors.md\":\"efb3b255\",\"docs_taro_taro-get-started.md\":\"2d17b978\",\"docs_taro_taro-start.md\":\"bc1d941d\",\"docs_tiptap_tiptap-tutorial.md\":\"169cd312\",\"docs_tiptap_tiptap-tutorial10.md\":\"4995940f\",\"docs_tiptap_tiptap-tutorial2.md\":\"e8261cda\",\"docs_tiptap_tiptap-tutorial3.md\":\"2b8989ab\",\"docs_tiptap_tiptap-tutorial4.md\":\"4b3b4ee0\",\"docs_tiptap_tiptap-tutorial5.md\":\"c609b186\",\"docs_tiptap_tiptap-tutorial6.md\":\"232727db\",\"docs_tiptap_tiptap-tutorial7.md\":\"f0d4a2cf\",\"docs_tiptap_tiptap-tutorial8.md\":\"8097fdc4\",\"docs_tiptap_tiptap-tutorial9.md\":\"a895e6fd\",\"docs_tool_2023-summary.md\":\"b7d23477\",\"docs_tool_2024-summary.md\":\"a2bea6ed\",\"docs_tool_blog.md\":\"a97c00c3\",\"docs_tool_chatgpt.md\":\"64d2f9fd\",\"docs_tool_chrome-extension.md\":\"c8ebf80c\",\"docs_tool_chrome-override.md\":\"df280a99\",\"docs_tool_debugging.md\":\"2237c653\",\"docs_tool_mac.md\":\"0e1c95d4\",\"docs_tool_mock.md\":\"f870ef30\",\"docs_tool_moment-api.md\":\"97dab011\",\"docs_tool_mvp.md\":\"7ce0db92\",\"docs_tool_np.md\":\"27c134c4\",\"docs_tool_prosemirror-tables.md\":\"d96a4d33\",\"docs_tool_vitepress-error.md\":\"f1681c92\",\"docs_tool_vscode-web-error.md\":\"5d1f4d59\",\"docs_tool_whistle.md\":\"416fde6b\",\"docs_tool_yarn-certificate.md\":\"426704b5\",\"docs_vite_componentLibrary.md\":\"9811b47b\",\"docs_vite_create-vite.md\":\"91126b85\",\"docs_vite_vite-env.md\":\"9824a888\",\"docs_vite_vite-mulit-import.md\":\"5f937992\",\"docs_vite_vite-react-cli.md\":\"5392f47a\",\"docs_vite_vite-react.md\":\"17b57220\",\"docs_vite_vite.md\":\"a0edea45\",\"docs_vite_vite3.0.md\":\"5df04598\",\"docs_vscode_vscode-markdown.md\":\"b505c392\",\"docs_vscode_vscode-todo.md\":\"6be2bfc0\",\"docs_vue_antd-form.md\":\"204aaa81\",\"docs_vue_antd-vue.md\":\"385a0332\",\"docs_vue_axios-token.md\":\"4cf444ee\",\"docs_vue_history-mode.md\":\"c2325d82\",\"docs_vue_keepAlive.md\":\"e7503703\",\"docs_vue_tjTodo.md\":\"d80363c7\",\"docs_vue_unplugin-auto-import.md\":\"a61fbfbf\",\"docs_vue_vue-scoped-issue.md\":\"952827a0\",\"docs_vue_vue3-jsx.md\":\"8a67bdbe\",\"docs_vue_vue3-lint-staged.md\":\"2be4ee5a\",\"docs_vue_vue3-unexpected-token.md\":\"767445c9\",\"docs_webrtc_getstarted-webrtc.md\":\"7d57f20f\",\"docs_webrtc_livekit-start.md\":\"de2bdef3\",\"docs_webrtc_webrtc-one.md\":\"9b7e47a8\",\"docs_wechat_uniapp-start.md\":\"07da5a17\",\"docs_wechat_wechat-app.md\":\"3f0fd965\",\"docs_work_360-develop.md\":\"ce63f570\",\"docs_work_babel.md\":\"e0d46c74\",\"docs_work_click-event.md\":\"b8cf1977\",\"docs_work_contentEdit-div-insert.md\":\"9af9c2bb\",\"docs_work_developer.md\":\"e02df631\",\"docs_work_echarts.md\":\"b8216a13\",\"docs_work_email-font.md\":\"3c016867\",\"docs_work_excalidraw-use.md\":\"56c8504a\",\"docs_work_excalidraw.md\":\"445901af\",\"docs_work_font-loading-speed.md\":\"c5c46bba\",\"docs_work_g2-vs-echarts.md\":\"dc1c8ab6\",\"docs_work_h5-app.md\":\"95a24150\",\"docs_work_html2canvas-bug.md\":\"aa08cf62\",\"docs_work_i18n.md\":\"9754c1a4\",\"docs_work_image-type.md\":\"81d0a196\",\"docs_work_jenkins-start.md\":\"85ee815a\",\"docs_work_js-long.md\":\"bfbfcaf5\",\"docs_work_malformed.md\":\"369ce091\",\"docs_work_mutationObserver.md\":\"dd0fee0e\",\"docs_work_node16-docker.md\":\"920943a0\",\"docs_work_one-react-screenshots.md\":\"dcfafe01\",\"docs_work_plop-express.md\":\"6901c904\",\"docs_work_puppeteer.md\":\"c5114799\",\"docs_work_react-ref.md\":\"4c52393d\",\"docs_work_report-2023.md\":\"08f31082\",\"docs_work_report-regular.md\":\"8a02a181\",\"docs_work_richeditor.md\":\"1a6da96c\",\"docs_work_sentry-cli-error.md\":\"a3855804\",\"docs_work_sentry-error.md\":\"5160adb4\",\"docs_work_sentry.md\":\"de015699\",\"docs_work_server-deploy.md\":\"5b9be54a\",\"docs_work_sse.md\":\"e9bedaa7\",\"docs_work_text-decoration.md\":\"cd7f16f0\",\"docs_work_unocss.md\":\"7a3b4dac\",\"docs_work_white-board.md\":\"07b67da2\",\"docs_work_word-cpu.md\":\"46be7690\",\"docs_work_zero-width-spaces.md\":\"5dd8ff07\"}")</script>
    <script type="module" async src="/blog/_assets/app.4aa5a5ca.js"></script>
  </body>
</html>