---
date: 2023-7-5
title: gitå¥‡æ·«æŠ€å·§ï¼šå¦‚ä½•ä¿®æ”¹commitå†å²è®°å½•çš„åå­—(æˆ‘çš„githubå¤´åƒæ€ä¹ˆæ²¡äº†ğŸ˜±)
tags:
  - git
describe: gitå¥‡æ·«æŠ€å·§ï¼šå¦‚ä½•ä¿®æ”¹commitæäº¤è®°å½•çš„åå­—
---

![gitlab-github-username.png](./images/gitlab-github-username.png)

## github çš„å¤´åƒä¸æ˜¾ç¤ºäº†ï¼Ÿ

![github-error-username](./images/github-error-usename.png)

å¦‚é¢˜ï¼Œæˆ‘çš„ github commit è®°å½•é‡Œé¢å¤´åƒä¸æ˜¾ç¤ºäº†ã€‚å¥½å¥‡æ€ªï¼Œéš¾é“æ˜¯æˆ‘ç½‘ç»œæœ‰é—®é¢˜å—ï¼Ÿå¯æ˜¯æˆ‘å·²ç»å¼€äº†æœ€é«˜é€Ÿçš„ç¿»å¢™äº†ã€‚å®šç›ä¸€çœ‹ ğŸ‘€ï¼ŒåŸæ¥æ˜¯ github çš„ç”¨æˆ·åä¸å¯¹ä¸­é—´å°‘äº†ä¸ª`1`ã€‚

å¯æ¶ï¼Œå› ä¸ºæ³¨å†Œ github æ¯”è¾ƒæ™šï¼Œæƒ³æ³¨å†Œçš„åå­—éƒ½è¢«æ³¨å†Œäº†ï¼Œæ‰€ä»¥åªèƒ½å§”å±ˆåœ¨ä¸­é—´åŠ ä¸ª`1`ã€‚

ä¸çŸ¥é“è¿˜æœ‰äººé‡è¿‡è¿™ä¸ªé—®é¢˜æ²¡ï¼Œgithub çš„ commit è®°å½•ç”¨æˆ·åä¸å¯¹ï¼Œå¯¼è‡´å¤´åƒä¹Ÿä¸èƒ½æ­£ç¡®æ˜¾ç¤ºå‡ºæ¥ï¼Œæäº¤äº†å¾ˆå¤šï¼Œå´ä¸€ç›´æ²¡æœ‰ contributionsã€‚

## äº§ç”ŸåŸå› 

é€šè¿‡`git config --global -l`æŸ¥çœ‹å…¨å±€é…ç½®ï¼Œä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™è¢«æˆ‘æ”¹æˆäº†`wangxiang`ï¼Œå’Œ github çš„ç”¨æˆ·åæ²¡å¯¹åº”ä¸Šï¼Œæ‰€ä»¥å¯¼è‡´æäº¤åˆ° github ä¸Šçš„ commit è®°å½•éƒ½å‡ºç°äº†é—®é¢˜ã€‚

![github-global-username](./images/github-global-usename.png)

å¤§å®¶éƒ½çŸ¥é“ï¼Œgit çš„é…ç½®æ–‡ä»¶å¯ä»¥æ˜¯å…¨å±€å’Œå½“å‰é¡¹ç›®ï¼Œå¦‚æœå½“å‰é¡¹ç›®æ²¡æœ‰é…ç½®ä¸ªäººä¿¡æ¯ï¼Œé‚£æäº¤ä»£ç æ—¶å°±ä¼šæ‹¿å…¨å±€é…ç½®çš„ä¿¡æ¯ã€‚

```bash
# é…ç½®å…¨å±€çº§åˆ«çš„config
git config --global user.name 'æ³¨å†Œå'
git config --global user.email 'æ³¨å†Œé‚®ç®±'
```

```bash
# é…ç½®é¡¹ç›®çº§åˆ«çš„config
git config --local user.name 'æ³¨å†Œå'
git config --local user.email 'æ³¨å†Œé‚®ç®±'
```

## å¦‚ä½•è§£å†³

å¦‚æœè¯»è¿‡æˆ‘è¿™ç¯‡æ–‡ç« [addã€commit...ğŸ‘€git å°±ä¼šè¿™å‡ ä¸ªæ“ä½œå—ï¼Ÿè¿›æ¥å­¦ç‚¹æ–°å§¿åŠ¿ï½](https://juejin.cn/post/7228869305549537336#heading-5)çš„å°ä¼™ä¼´ï¼Œåº”è¯¥éƒ½çŸ¥é“å¯ä»¥ä½¿ç”¨`amend`æ¥ä¿®æ”¹æäº¤ä¿¡æ¯ï¼ˆPSï¼šå¦‚æœæ²¡çœ‹è¿‡å»ºè®®å­¦ä¸€æ³¢ï¼Œå¹²è´§æ»¡æ»¡ ğŸ‘ï¼‰ã€‚

ä¹‹å‰ä½¿ç”¨`amend`ä»…ä»…åªæ˜¯å¯¹æäº¤ä¿¡æ¯å’Œæ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œè€Œè¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å®ƒæ¥å¯¹æäº¤**ä½œè€…ä¿¡æ¯è¿›è¡Œä¿®æ”¹**ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š

```bash
git commit --amend --author="{username} <{email}>" --no-edit
```

æ¯”å¦‚æˆ‘è¿™é‡Œæäº¤åˆ°å…¬å¸ gitlab ä¸Šçš„ä»£ç ï¼Œæäº¤ä¿¡æ¯æ˜¾ç¤ºçš„åå­—ä¸ä¹‹å‰çš„ä¸ç»Ÿä¸€ï¼š

![git-commit-amend.png](./images/git-commit-amend.png)

è¿™æ—¶å€™å°±å¯ä»¥ç”¨ä¸Šè¿°å‘½ä»¤æ¥ä¿®æ”¹ï¼Œæ¯”å¦‚ä¿®æ”¹ä¸ºåç§°ï¼š`ç‹ç¿”`ã€é‚®ç®±ï¼š`wangxiang@qimingpian.com`ï¼š

```bash
git commit --amend --author="ç‹ç¿” <wangxiang@qimingpian.com>" --no-edit
```

![git-commit-amend1.png](./images/git-commit-amend1.png)

è¿™æ ·å°±æˆåŠŸä¿®æ”¹äº†æäº¤è®°å½•çš„æäº¤äººä¿¡æ¯ã€‚

å¦‚æœå·²ç»ä¿®æ”¹äº† git config ä¸­çš„ç”¨æˆ·åå’Œé‚®ç®±ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ï¼š

```bash
git commit --amend --reset-author --no-edit
```

**æ³¨æ„ï¼šå¦‚æœå·²ç»æäº¤åˆ°è¿œç¨‹ï¼Œä¿®æ”¹å®Œæˆåï¼Œéœ€è¦ä½¿ç”¨`git push -f`ã€‚**

ä½†`amend`åªæ”¯æŒ**ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡çš„æäº¤**ï¼Œè¦æ˜¯åƒæˆ‘ä¸€æ ·ä¹‹å‰çš„æäº¤åå­—éƒ½é”™äº†ï¼Œé‚£è¦æ€ä¹ˆæ”¹å‘¢ï¼ŸğŸ¤”

### ä½¿ç”¨ filter-branch æ‰¹é‡ä¿®æ”¹

`filter-branch`æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡[å®˜æ–¹æ–‡æ¡£](https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E9%87%8D%E5%86%99%E5%8E%86%E5%8F%B2#_%E6%A0%B8%E6%AD%A6%E5%99%A8%E7%BA%A7%E9%80%89%E9%A1%B9filter_branch)çŸ¥é“ï¼Œå®ƒä¸»è¦ç”¨æ¥**æ‰¹é‡ä¿®æ”¹ git å†å²è®°å½•**ï¼Œè¿™ä¸æ­£åˆæˆ‘æ„å˜›ï¼

æˆ‘ä»¬çœ‹ä¸‹`filter-branch`å¯ä»¥ç”¨æ¥åšä»€ä¹ˆï¼š

1. ä»æ¯ä¸€ä¸ªæäº¤ä¸­ç§»é™¤ä¸€ä¸ªæ–‡ä»¶ï¼›
2. å…¨å±€ä¿®æ”¹é‚®ç®±åœ°å€ï¼›
3. ä½¿ä¸€ä¸ªå­ç›®å½•åšä¸ºæ–°çš„æ ¹ç›®å½•ã€‚

æˆ‘è¿™é‡Œç”¨å®˜æ–¹æä¾›çš„ä»£ç æ¥åšä¸ªä¾‹å­ï¼Œæ¯”å¦‚æˆ‘è¿™ä¸ªé¡¹ç›®çš„æäº¤åå­—å’Œé‚®ç®±å’Œ github å¯¹ä¸ä¸Šï¼Œé€šè¿‡[git logs](https://juejin.cn/post/7228869305549537336#heading-11)æŸ¥çœ‹æäº¤è®°å½•:

![git-filter-logs](./images/git-filter-logs.png)

æ¥ç€ä½¿ç”¨`--commit-filter`æ‰¹é‡ä¿®æ”¹ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š

1. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º`changeCommit.sh`ï¼š

   ```bash
     # changeCommit.sh
     git filter-branch --commit-filter '
       if [ "$GIT_AUTHOR_EMAIL" = "wangxiang@qimingpian.com" ];
       then
               GIT_AUTHOR_NAME="wang1xiang";
               GIT_AUTHOR_EMAIL="756638369@qq.com";
               git commit-tree "$@";
       else
               git commit-tree "$@";
       fi' HEAD
   ```

   è¿™ä¸ªè„šæœ¬å¾ˆç®€å•ï¼Œåªè¦ç¬¦åˆ`"$GIT_AUTHOR_EMAIL" = "wangxiang@qimingpian.com"`çš„æäº¤ï¼Œå°±æŠŠ`GIT_AUTHOR_NAME`æ”¹ä¸º`wang1xiang`ï¼Œ`GIT_AUTHOR_EMAIL`æ”¹ä¸º`756638369@qq.com`ã€‚

2. æ‰§è¡Œæ­¤è„šæœ¬ï¼Œè¿‡ç¨‹ç•¥å¾®æœ‰ç‚¹æ…¢

   .![git-filter-branch.png](./images/git-filter-branch.png)

   æ‰§è¡Œå®Œæˆåï¼Œå±•ç¤ºæˆä¸Šå›¾è¿™æ ·è¯´æ˜æ‰§è¡ŒæˆåŠŸï¼Œ

   å¦‚æœæ‰§è¡Œæ—¶æç¤º`A previous backup already exists in refs/original/`ï¼Œè¯´æ˜å·²ç»æ‰§è¡Œè¿‡ä¸€æ¬¡ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è§£å†³ï¼š

   ```bash
   git filter-branch -f --index-filter 'git rm --cached --ignore-unmatch Rakefile' HEAD

   ```

   ![git-filter-branch-error](./images/git-filter-branch-error.png)

3. æ‰§è¡Œå®Œæˆåï¼Œé€šè¿‡[git logs](https://juejin.cn/post/7228869305549537336#heading-11)å†æ¬¡æŸ¥çœ‹ï¼š

   ![git-filter-logs1.png](./images/git-filter-logs1.png)

æœ€åï¼Œåœ¨`git push -f`å°±å¤§åŠŸå‘Šæˆäº† ğŸ‰ï¼ï¼Œå†çœ‹ä¸‹ github çš„ commit å†å²ï¼Œä¸é”™ï¼Œå¤´åƒéƒ½å‡ºæ¥äº†ã€‚
![github-right-usename](./images/github-right-usename.png)

## æœ€å

æœ¬æ–‡ä¸»è¦è®²äº†ä¿®æ”¹ git æäº¤è®°å½•ä¸­ç”¨æˆ·åå’Œé‚®ç®±çš„ä¸¤ç§æ–¹å¼ï¼Œè¿™å¯èƒ½æ˜¯å¾ˆå¤šäººéƒ½ä¸ä¼šæ¥è§¦åˆ°çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘æ‰ä¼šç§°å®ƒä¸ºâ€œå¥‡æ·«æŠ€å·§â€ï¼Œä½†åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼ˆæ¯”å¦‚æˆ‘é‡åˆ°çš„é—®é¢˜ï¼‰è¿˜æ˜¯æŒºæœ‰æ•ˆçš„ã€‚å¦‚æœè§‰å¾—ç°åœ¨å¯¹ä½ æ²¡ç”¨çš„è¯ï¼Œå…ˆæ”¶è—ï¼Œæ²¡å‡†ä»€ä¹ˆæ—¶å€™å°±ç”¨ä¸Šäº†ã€‚

ä»¥ä¸Šå°±æ˜¯æœ¬æ–‡çš„å…¨éƒ¨å†…å®¹ï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµå’Œæ”¶è— ğŸ™ï¼Œå¦‚æœå‘ç°æœ‰ä»€ä¹ˆé”™è¯¯æˆ–è€…æ›´å¥½çš„è§£å†³æ–¹æ¡ˆåŠå»ºè®®ï¼Œæ¬¢è¿éšæ—¶è”ç³»ã€‚
